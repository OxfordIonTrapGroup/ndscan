

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ndscan.experiment API &mdash; ndscan  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://oxfordiontrapgroup.github.io/ndscan/apidocs.html"/>
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="ndscan" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ndscan
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ndscan.experiment API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fragments">Fragments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.fragment"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.fragment</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.parameters</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.result_channels"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.result_channels</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scans">Scans</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.scan_generator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_generator</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.subscan"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.subscan</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.default_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.default_analysis</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.scan_runner"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_runner</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#experiment-entry-points">Experiment entry points</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code> module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ndscan</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>ndscan.experiment API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OxfordIonTrapGroup/ndscan/blob/master/docs/apidocs.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-ndscan.experiment">
<span id="ndscan-experiment-api"></span><h1>ndscan.experiment API<a class="headerlink" href="#module-ndscan.experiment" title="Permalink to this headline">¶</a></h1>
<p>Experiment-side <code class="docutils literal notranslate"><span class="pre">ndscan</span></code> interface</p>
<p><code class="docutils literal notranslate"><span class="pre">ndscan.experiment</span></code> contains the code for implementing the <code class="docutils literal notranslate"><span class="pre">ndscan</span></code> primitives from
ARTIQ experiments (as opposed to submitting the experiments with certain parameters, or
later analysing and plotting the generated data).</p>
<p>The top-level module provides a single convenient way to import commonly used symbols
from experiment client code, like <code class="docutils literal notranslate"><span class="pre">artiq.experiment</span></code> does for upstream ARTIQ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import commonly used symbols, including all of artiq.experiment:</span>
<span class="kn">from</span> <span class="nn">ndscan.experiment</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="fragments">
<h2>Fragments<a class="headerlink" href="#fragments" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-ndscan.experiment.fragment">
<span id="ndscan-experiment-fragment-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.fragment" title="ndscan.experiment.fragment"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.fragment</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.fragment" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="ndscan.experiment.fragment.Fragment">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.fragment.</code><code class="sig-name descname">Fragment</code><span class="sig-paren">(</span><em class="sig-param">managers_or_parent</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Main building block.</p>
<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">fragment_path: List[str], *args, **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise this fragment instance; called from the <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>
constructor.</p>
<p>This sets up the machinery for registering parameters and result channels with
the fragment tree, and then calls <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> to actually perform the
fragment-specific setup. This method should not typically be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Params fragment_path</dt>
<dd class="field-odd"><p>Full path of the fragment, as a list starting from the
root. For instance, <code class="docutils literal notranslate"><span class="pre">[]</span></code> for the top-level fragment, or <code class="docutils literal notranslate"><span class="pre">[&quot;foo&quot;,</span> <span class="pre">&quot;bar&quot;]</span></code>
for a subfragment created by <code class="docutils literal notranslate"><span class="pre">setattr_fragment(&quot;bar&quot;,</span> <span class="pre">…)</span></code> in a fragment
created by <code class="docutils literal notranslate"><span class="pre">setattr_fragment(&quot;foo&quot;,</span> <span class="pre">…)</span></code>.</p>
</dd>
<dt class="field-even">Params args</dt>
<dd class="field-even"><p>Arguments to be forwarded to <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
</dd>
<dt class="field-odd">Params kwargs</dt>
<dd class="field-odd"><p>Keyword arguments to be forwarded to <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.host_setup">
<code class="sig-name descname">host_setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.host_setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.host_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform host-side initialisation.</p>
<p>For fragments used as part of an on-core-device scan (i.e. with an <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code>
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>/<code class="xref py py-meth docutils literal notranslate"><span class="pre">run_once()</span></code>), this will be called on the host,
immediately before the top-level kernel function is entered.</p>
<p>Typical uses include initialising member variables for latter use in <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code>
functions, and setting parameters not modifiable from kernels (e.g. because
modifying a parameter requires launching another experiment to effect the
change).</p>
<p>The default implementation calls <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a> recursively on all
subfragments. When overriding it in a fragment with subfragments, consider
forwarding to the default implementation (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">host_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">initialise_some_things</span><span class="p">()</span>

    <span class="c1"># To continue to initialise all subfragments, invoke the parent</span>
    <span class="c1"># implementation:</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">host_setup</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.device_setup">
<code class="sig-name descname">device_setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform core-device-side initialisation.</p>
<p>A typical implementation will make sure that any hardware state represented by
the fragment (e.g. some DAC voltages, DDS frequencies, etc.) is updated to
match the fragment parameters.</p>
<p>If the fragment is used as part of a scan, <code class="docutils literal notranslate"><span class="pre">device_setup()</span></code> will be called
immediately before each <code class="docutils literal notranslate"><span class="pre">ExpFragment.run_once()</span></code> call (and, for on-core-device
scans, from within the same kernel).</p>
<p>The default implementation calls <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup_subfragments" title="ndscan.experiment.fragment.Fragment.device_setup_subfragments"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup_subfragments()</span></code></a> to initialise
all subfragments. When overriding it, consider forwarding to it too unless a
special initialisation order, etc. is required (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@kernel</span>
<span class="k">def</span> <span class="nf">device_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device_setup_subfragments</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">break_realtime</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_frequency</span><span class="o">.</span><span class="n">changed_after_use</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_dds</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_frequency</span><span class="o">.</span><span class="n">use</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">my_ttl</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.device_setup_subfragments">
<code class="sig-name descname">device_setup_subfragments</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_setup_subfragments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_setup_subfragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a> on all subfragments.</p>
<p>This is the default implementation for <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>, but is kept
separate so that subfragments overriding <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a> can still access
it. (ARTIQ Python does not support calling superclass implementations in a
polymorphic way – <code class="docutils literal notranslate"><span class="pre">Fragment.device_setup(self)</span></code> could be used from one
subclass, but would cause the argument type to be inferred as that subclass.
Only direct member function calls are special-cased to be generic on the
<cite>self</cite> type.)</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.host_cleanup">
<code class="sig-name descname">host_cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.host_cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.host_cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform host-side cleanup after an experiment has been run.</p>
<p>This is the equivalent of <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a> to be run <em>after</em> the main
experiment. It is executed on the host after the top-level kernel function, if
any, has been left, as control is about to leave the experiment (whether because
a scan has been finished, or the experiment is about to be paused for a
higher-priority run to be scheduled in.</p>
<p>Typically, fragments should strive to completely initialise the state of all
their dependencies for robustness. As such, manual cleanup should almost never
be necessary.</p>
<p>By default, calls <cite>host_cleanup()</cite> on all subfragments, in reverse
initialisation order. The default implementation catches all exceptions thrown
from cleanups and converts them into log messages to ensure no cleanups are
skipped. As there will be no exception propagating to the caller to mark the
experiment as failed, failing cleanups should be avoided.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">host_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tear_down_some_things</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">host_setup</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.device_cleanup">
<code class="sig-name descname">device_cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform core-device-side teardown.</p>
<p>This is the equivalent of <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>, run after the main experiment.
It is executed on the core device every time the top-level kernel is about to be
left.</p>
<p>Thus, if the fragment is used as part of a scan, <code class="docutils literal notranslate"><span class="pre">device_cleanup()</span></code> will be
typically be called once at the end of each scan (while <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>
will be called once per scan point).</p>
<p>The default implementation calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">device_clean_subfragments()</span></code> to clean up
all subfragments in reverse initialisation order. When overriding it, consider
forwarding to it too (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@kernel</span>
<span class="k">def</span> <span class="nf">device_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">clean_up_some_things</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device_cleanup_subfragments</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.device_cleanup_subfragments">
<code class="sig-name descname">device_cleanup_subfragments</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_cleanup_subfragments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_cleanup_subfragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a> on all subfragments.</p>
<p>This is the default implementation for <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a>, but is kept
separate so that subfragments overriding <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a> can still access
it.</p>
<p><a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a> is invoked on all subfragments in reverse initialisation
order. To ensure no cleanups are skipped, any exceptions thrown from cleanups
are caught and converted into log messages. As there will be no exception
propagating to the caller to mark the experiment as failed, failing cleanups
should be avoided.</p>
<p>(ARTIQ Python does not support calling superclass implementations in a
polymorphic way – <code class="docutils literal notranslate"><span class="pre">Fragment.device_setup(self)</span></code> could be used from one
concrete fragment in the whole project, but would cause the argument type to be
inferred as that subclass. Only direct member function calls are special-cased
to be generic on the <cite>self</cite> type.)</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.build_fragment">
<code class="sig-name descname">build_fragment</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.build_fragment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise this fragment, building up the hierarchy of subfragments,
parameters and result channels.</p>
<p>This is where any constructor-type initialisation should take place, similar to
the role <code class="docutils literal notranslate"><span class="pre">build()</span></code> has for a bare <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>.</p>
<p>While this method executes, the various <code class="docutils literal notranslate"><span class="pre">setattr_*()</span></code> functions can be used
to create subfragments, parameters, and result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Any extra arguments that were passed to the <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>
constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments that were passed to the
<code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> constructor.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.setattr_fragment">
<code class="sig-name descname">setattr_fragment</code><span class="sig-paren">(</span><em class="sig-param">name: str, fragment_class: Type[Fragment], *args, **kwargs</em><span class="sig-paren">)</span> &#x2192; ndscan.experiment.fragment.Fragment<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_fragment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a subfragment of the given name and type.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The fragment name; part of the fragment path. Must be a valid
Python identifier; the fragment will be accessible as <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>fragment_class</strong> – The type of the subfragment to instantiate.</p></li>
<li><p><strong>args</strong> – Any extra arguments to forward to the subfragment
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> call.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to forward to the subfragment
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> call.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The newly created fragment instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.setattr_param">
<code class="sig-name descname">setattr_param</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">param_class: Type</em>, <em class="sig-param">description: str</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; ndscan.experiment.parameters.ParamHandle<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a parameter of the given name and type.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The parameter name, to be part of its FQN. Must be a valid Python
identifier; the parameter handle will be accessible as <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>param_class</strong> – The type of parameter to instantiate.</p></li>
<li><p><strong>description</strong> – The human-readable parameter name.</p></li>
<li><p><strong>args</strong> – Any extra arguments to pass to the <code class="docutils literal notranslate"><span class="pre">param_class</span></code> constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to pass to the the <code class="docutils literal notranslate"><span class="pre">param_class</span></code>
constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The newly created parameter handle.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.setattr_param_rebind">
<code class="sig-name descname">setattr_param_rebind</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">original_owner: ndscan.experiment.fragment.Fragment</em>, <em class="sig-param">original_name: Optional[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; ndscan.experiment.parameters.ParamHandle<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_param_rebind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_param_rebind" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a parameter that overrides the value of a subfragment parameter.</p>
<p>The most common use case for this is to specialise the operation of a generic
subfragment. For example, there might be a fragment <code class="docutils literal notranslate"><span class="pre">Fluoresce</span></code> that drives
a cycling transition in an ion with parameters for intensity and detuning.
Higher-level fragments for Doppler cooling, readout, etc. might then use
<code class="docutils literal notranslate"><span class="pre">Fluoresce</span></code>, rebinding its intensity and detuning parameters to values and
defaults appropriate for those particular tasks.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The parameter name, to be part of its FQN. Must be a valid Python
identifier; the parameter handle will be accessible as <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>original_owner</strong> – The fragment owning the parameter to rebind.</p></li>
<li><p><strong>original_name</strong> – The name of the original parameter (i.e.
<code class="docutils literal notranslate"><span class="pre">&lt;original_owner&gt;.&lt;original_name&gt;</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any attributes to override in the parameter metadata, which
defaults to that of the original parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The newly created parameter handle.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.setattr_result">
<code class="sig-name descname">setattr_result</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">channel_class: Type[ndscan.experiment.result_channels.ResultChannel] = &lt;class 'ndscan.experiment.result_channels.FloatChannel'&gt;</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; ndscan.experiment.result_channels.ResultChannel<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a result channel of the given name and type.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The result channel name, to be part of its full path. Must be a
valid Python identifier. The channel instance will be accessible as
<code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>channel_class</strong> – The type of result channel to instantiate.</p></li>
<li><p><strong>args</strong> – Any extra arguments to pass to the <code class="docutils literal notranslate"><span class="pre">channel_class</span></code> constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to pass to the the <code class="docutils literal notranslate"><span class="pre">channel_class</span></code>
constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The newly created result channel instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.override_param">
<code class="sig-name descname">override_param</code><span class="sig-paren">(</span><em class="sig-param">param_name: str</em>, <em class="sig-param">initial_value: Any = None</em><span class="sig-paren">)</span> &#x2192; Tuple[Any, ndscan.experiment.parameters.ParamStore]<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.override_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.override_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Override the parameter with the given name and set it to the provided value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_name</strong> – The name of the parameter.</p></li>
<li><p><strong>initial_value</strong> – The initial value for the parameter. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the
default from the parameter schema is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(param,</span> <span class="pre">store)</span></code> of the parameter metadata and the newly
created <code class="xref py py-class docutils literal notranslate"><span class="pre">ParamStore</span></code> instance that the parameter handles are now
bound to.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.init_params">
<code class="sig-name descname">init_params</code><span class="sig-paren">(</span><em class="sig-param">overrides: Dict[str</em>, <em class="sig-param">List[Tuple[str</em>, <em class="sig-param">ndscan.experiment.parameters.ParamStore]]] = {}</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.init_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.init_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise free parameters of this fragment and all its subfragments.</p>
<p>If, for a given parameter, a relevant override is given, the specified
ParamStore is used. Otherwise, the default value is evaluated and a new store
pointing to it created.</p>
<p>This method should be called before any of the fragment’s user-defined functions
are used (but after the constructor -&gt; <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build" title="ndscan.experiment.fragment.Fragment.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code></a> -&gt; :meth`build_fragment()`
has completed). Most likely, the top-level fragment will be called from a
<a class="reference internal" href="#module-ndscan.experiment.entry_point" title="ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code></a> which already take care of this. In cases
where fragments are used in a different context, for example from a standalone
<code class="docutils literal notranslate"><span class="pre">EnvExperiment</span></code>, this method must be called manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overrides</strong> – A dictionary mapping parameter FQNs to lists of overrides.
Each override is specified as a tuple <cite>(pathspec, store)</cite> of a path spec and
the store to use for parameters the path of which matches the spec.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.Fragment.recompute_param_defaults">
<code class="sig-name descname">recompute_param_defaults</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.recompute_param_defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.recompute_param_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Recompute default values of the parameters of this fragment and all its
subfragments.</p>
<p>For parameters where the default value was previously used, the expression is
evaluated again – thus for instance fetching new dataset values –, and assigned
to the existing parameter store.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.fragment.ExpFragment">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.fragment.</code><code class="sig-name descname">ExpFragment</code><span class="sig-paren">(</span><em class="sig-param">managers_or_parent</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Fragment that supports the notion of being run to produce results.</p>
<dl class="method">
<dt id="ndscan.experiment.fragment.ExpFragment.prepare">
<code class="sig-name descname">prepare</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment.prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare this instance for execution
(see <code class="docutils literal notranslate"><span class="pre">artiq.language.environment.Experiment.prepare</span></code>).</p>
<p>This is invoked only once per (sub)scan, after <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> but
before <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a>. At this point, parameters, datasets and devices
be accessed, but devices must not yet be.</p>
<p>For top-level scans, this can (and will) be executed in the <cite>prepare</cite> scheduler
pipeline stage.</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.ExpFragment.run_once">
<code class="sig-name descname">run_once</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment.run_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the experiment described by the fragment once with the current
parameters, producing one set of results (if any).</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.fragment.ExpFragment.get_default_analyses">
<code class="sig-name descname">get_default_analyses</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Iterable[ndscan.experiment.default_analysis.DefaultAnalysis]<a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment.get_default_analyses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment.get_default_analyses" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of <a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultAnalysis</span></code></a> instances describing analyses
(fits, etc.) for this fragment.</p>
<p>Analyses are only run if the fragment is scanned along the axes required for
them to apply.</p>
<p>This is a class method in spirit, and might become one in the future.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="ndscan.experiment.fragment.TransitoryError">
<em class="property">exception </em><code class="sig-prename descclassname">ndscan.experiment.fragment.</code><code class="sig-name descname">TransitoryError</code><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#TransitoryError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.TransitoryError" title="Permalink to this definition">¶</a></dt>
<dd><p>Transitory error encountered while executing a fragment, which is expected to
clear itself up if it is attempted again without any further changes.</p>
</dd></dl>

<dl class="exception">
<dt id="ndscan.experiment.fragment.RestartKernelTransitoryError">
<em class="property">exception </em><code class="sig-prename descclassname">ndscan.experiment.fragment.</code><code class="sig-name descname">RestartKernelTransitoryError</code><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#RestartKernelTransitoryError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.fragment.RestartKernelTransitoryError" title="Permalink to this definition">¶</a></dt>
<dd><p>Transitory error where the kernel should be restarted before retrying.</p>
</dd></dl>

</div>
<div class="section" id="module-ndscan.experiment.parameters">
<span id="ndscan-experiment-parameters-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.parameters" title="ndscan.experiment.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.parameters</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.parameters" title="Permalink to this headline">¶</a></h3>
<p>Fragment-side parameter containers.</p>
</div>
<div class="section" id="module-ndscan.experiment.result_channels">
<span id="ndscan-experiment-result-channels-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.result_channels" title="ndscan.experiment.result_channels"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.result_channels</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.result_channels" title="Permalink to this headline">¶</a></h3>
<p>Result handling building blocks.</p>
<dl class="class">
<dt id="ndscan.experiment.result_channels.LastValueSink">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">LastValueSink</code><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#LastValueSink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.LastValueSink" title="Permalink to this definition">¶</a></dt>
<dd><p>Sink that stores the last-pushed value.</p>
<dl class="method">
<dt id="ndscan.experiment.result_channels.LastValueSink.get_last">
<code class="sig-name descname">get_last</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Any<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#LastValueSink.get_last"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.LastValueSink.get_last" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the last-pushed value, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if none yet.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.result_channels.ArraySink">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">ArraySink</code><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink" title="Permalink to this definition">¶</a></dt>
<dd><p>Sink that stores all pushed values in a list.</p>
<dl class="method">
<dt id="ndscan.experiment.result_channels.ArraySink.get_all">
<code class="sig-name descname">get_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[Any]<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink.get_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink.get_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all previously pushed values.</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.result_channels.ArraySink.clear">
<code class="sig-name descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the list of previously pushed values.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.result_channels.AppendingDatasetSink">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">AppendingDatasetSink</code><span class="sig-paren">(</span><em class="sig-param">managers_or_parent</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#AppendingDatasetSink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.AppendingDatasetSink" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="ndscan.experiment.result_channels.AppendingDatasetSink.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">key: str</em>, <em class="sig-param">broadcast: bool = True</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#AppendingDatasetSink.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.AppendingDatasetSink.build" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – Dataset key to store results in. Set to an array on the first push,
and subsequently appended to.</p></li>
<li><p><strong>broadcast</strong> – Whether to set the dataset in broadcast mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.result_channels.AppendingDatasetSink.get_all">
<code class="sig-name descname">get_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[Any]<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#AppendingDatasetSink.get_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.AppendingDatasetSink.get_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Read back the previously pushed values from the target dataset (if any).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.result_channels.ScalarDatasetSink">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">ScalarDatasetSink</code><span class="sig-paren">(</span><em class="sig-param">managers_or_parent</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink" title="Permalink to this definition">¶</a></dt>
<dd><p>Sink that writes pushed results to a dataset, overwriting its previous value
if any.</p>
<dl class="method">
<dt id="ndscan.experiment.result_channels.ScalarDatasetSink.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">key: str</em>, <em class="sig-param">broadcast: bool = True</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink.build" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – Dataset key to write the value to.</p></li>
<li><p><strong>broadcast</strong> – Whether to set the dataset in broadcast mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.result_channels.ScalarDatasetSink.get_last">
<code class="sig-name descname">get_last</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Any<a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink.get_last"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink.get_last" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the last pushed value, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if none yet.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.result_channels.FloatChannel">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">FloatChannel</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">description: str =</em>, <em class="sig-param">display_hints: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">min=None</em>, <em class="sig-param">max=None</em>, <em class="sig-param">unit: str =</em>, <em class="sig-param">scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#FloatChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.FloatChannel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ndscan.experiment.result_channels.IntChannel">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">IntChannel</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">description: str =</em>, <em class="sig-param">display_hints: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">min=None</em>, <em class="sig-param">max=None</em>, <em class="sig-param">unit: str =</em>, <em class="sig-param">scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#IntChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.IntChannel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ndscan.experiment.result_channels.OpaqueChannel">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.result_channels.</code><code class="sig-name descname">OpaqueChannel</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">description: str =</em>, <em class="sig-param">display_hints: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">save_by_default: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#OpaqueChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.result_channels.OpaqueChannel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="scans">
<h2>Scans<a class="headerlink" href="#scans" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-ndscan.experiment.scan_generator">
<span id="ndscan-experiment-scan-generator-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.scan_generator" title="ndscan.experiment.scan_generator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_generator</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.scan_generator" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="ndscan.experiment.scan_generator.ScanGenerator">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_generator.</code><code class="sig-name descname">ScanGenerator</code><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates points along a single scan axis to be visited.</p>
<dl class="method">
<dt id="ndscan.experiment.scan_generator.ScanGenerator.has_level">
<code class="sig-name descname">has_level</code><span class="sig-paren">(</span><em class="sig-param">level: int</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator.has_level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator.has_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ndscan.experiment.scan_generator.ScanGenerator.points_for_level">
<code class="sig-name descname">points_for_level</code><span class="sig-paren">(</span><em class="sig-param">level: int</em>, <em class="sig-param">rng=None</em><span class="sig-paren">)</span> &#x2192; List[Any]<a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator.points_for_level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator.points_for_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ndscan.experiment.scan_generator.ScanGenerator.describe_limits">
<code class="sig-name descname">describe_limits</code><span class="sig-paren">(</span><em class="sig-param">target: Dict[str, Any]</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator.describe_limits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator.describe_limits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_generator.RefiningGenerator">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_generator.</code><code class="sig-name descname">RefiningGenerator</code><span class="sig-paren">(</span><em class="sig-param">lower</em>, <em class="sig-param">upper</em>, <em class="sig-param">randomise_order</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#RefiningGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.RefiningGenerator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_generator.LinearGenerator">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_generator.</code><code class="sig-name descname">LinearGenerator</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">stop</em>, <em class="sig-param">num_points</em>, <em class="sig-param">randomise_order</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#LinearGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.LinearGenerator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_generator.ListGenerator">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_generator.</code><code class="sig-name descname">ListGenerator</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">randomise_order</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ListGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ListGenerator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_generator.ScanOptions">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_generator.</code><code class="sig-name descname">ScanOptions</code><span class="sig-paren">(</span><em class="sig-param">num_repeats: int = 1</em>, <em class="sig-param">randomise_order_globally: bool = False</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanOptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ndscan.experiment.subscan">
<span id="ndscan-experiment-subscan-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.subscan" title="ndscan.experiment.subscan"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.subscan</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.subscan" title="Permalink to this headline">¶</a></h3>
<p>Implements subscans, that is, the ability for an <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> to scan
another child fragment as part of its execution.</p>
<dl class="class">
<dt id="ndscan.experiment.subscan.Subscan">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.subscan.</code><code class="sig-name descname">Subscan</code><span class="sig-paren">(</span><em class="sig-param">run_fn: Callable[[ndscan.experiment.fragment.ExpFragment, ndscan.experiment.scan_runner.ScanSpec, List[ndscan.experiment.result_channels.ArraySink]], None], fragment: ndscan.experiment.fragment.ExpFragment, possible_axes: Dict[ndscan.experiment.parameters.ParamHandle, ndscan.experiment.scan_runner.ScanAxis], schema_channel: ndscan.experiment.result_channels.SubscanChannel, coordinate_channels: List[ndscan.experiment.result_channels.ResultChannel], child_result_sinks: Dict[ndscan.experiment.result_channels.ResultChannel, ndscan.experiment.result_channels.ArraySink], aggregate_result_channels: Dict[ndscan.experiment.result_channels.ResultChannel, ndscan.experiment.result_channels.ResultChannel], short_child_channel_names: Dict[str, ndscan.experiment.result_channels.ResultChannel]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#Subscan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.subscan.Subscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle returned by <a class="reference internal" href="#ndscan.experiment.subscan.setattr_subscan" title="ndscan.experiment.subscan.setattr_subscan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setattr_subscan()</span></code></a>, allowing the subscan to actually be
executed.</p>
<dl class="method">
<dt id="ndscan.experiment.subscan.Subscan.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">axis_generators: List[Tuple[ndscan.experiment.parameters.ParamHandle, ndscan.experiment.scan_generator.ScanGenerator]], options=&lt;ndscan.experiment.scan_generator.ScanOptions object&gt;, execute_default_analyses=True</em><span class="sig-paren">)</span> &#x2192; Tuple[Dict[ndscan.experiment.parameters.ParamHandle, list], Dict[ndscan.experiment.result_channels.ResultChannel, list]]<a class="reference internal" href="_modules/ndscan/experiment/subscan.html#Subscan.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.subscan.Subscan.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the subscan with the given axis iteration specifications, and return the
data point coordinates/result channel values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis_generators</strong> – The list of scan axes (dimensions). Each element is a
tuple of parameter to scan (handle must have been passed to
<a class="reference internal" href="#ndscan.experiment.subscan.setattr_subscan" title="ndscan.experiment.subscan.setattr_subscan"><code class="xref py py-func docutils literal notranslate"><span class="pre">setattr_subscan()</span></code></a> to set up), and the <code class="xref py py-class docutils literal notranslate"><span class="pre">ScanGenerator</span></code> to use
to generate the points.</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">ScanOptions</span></code> to control scan execution.</p></li>
<li><p><strong>execute_default_analyses</strong> – Whether to run any default analyses associated
with the subfragment after the scan is complete.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(coordinates,</span> <span class="pre">values)</span></code>, each a dictionary mapping parameter
handles resp. result channels to lists of their values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ndscan.experiment.subscan.setattr_subscan">
<code class="sig-prename descclassname">ndscan.experiment.subscan.</code><code class="sig-name descname">setattr_subscan</code><span class="sig-paren">(</span><em class="sig-param">owner: ndscan.experiment.fragment.Fragment, scan_name: str, fragment: ndscan.experiment.fragment.ExpFragment, axis_params: List[Tuple[ndscan.experiment.fragment.Fragment, str]], save_results_by_default: bool = True</em><span class="sig-paren">)</span> &#x2192; ndscan.experiment.subscan.Subscan<a class="reference internal" href="_modules/ndscan/experiment/subscan.html#setattr_subscan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.subscan.setattr_subscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up a scan for the given subfragment.</p>
<p>Result channels are set up to expose the scan data in the owning fragment for
introspectability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> – The fragment to add the subscan to.</p></li>
<li><p><strong>scan_name</strong> – Name of the scan; appears in result channel names, and the
<a class="reference internal" href="#ndscan.experiment.subscan.Subscan" title="ndscan.experiment.subscan.Subscan"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subscan</span></code></a> instance will be available as <code class="docutils literal notranslate"><span class="pre">owner.&lt;scan_name&gt;</span></code>.</p></li>
<li><p><strong>fragment</strong> – The runnable fragment to iterate over in the scan. Must be a
subfragment of <code class="docutils literal notranslate"><span class="pre">owner</span></code>.</p></li>
<li><p><strong>axis_params</strong> – List of <cite>(fragment, param_name)</cite> tuples defining the axes to be
scanned. It is possible to specify more axes than are actually used; they will
be overridden and set to their default values.</p></li>
<li><p><strong>save_results_by_default</strong> – Passed on to all derived result channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#ndscan.experiment.subscan.Subscan" title="ndscan.experiment.subscan.Subscan"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subscan</span></code></a> instance to use to actually execute the scan.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ndscan.experiment.default_analysis">
<span id="ndscan-experiment-default-analysis-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.default_analysis" title="ndscan.experiment.default_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.default_analysis</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.default_analysis" title="Permalink to this headline">¶</a></h3>
<p>Declarative fits, to be excecuted locally by the user interface displaying the data as
it comes in.</p>
<dl class="class">
<dt id="ndscan.experiment.default_analysis.Annotation">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.default_analysis.</code><code class="sig-name descname">Annotation</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">coordinates: dict = {}</em>, <em class="sig-param">parameters: dict = {}</em>, <em class="sig-param">data: dict = {}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#Annotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.Annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotation to be displayed alongside scan result data, recording derived
quantities (e.g. a fit minimizer).</p>
</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.default_analysis.DefaultAnalysis">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.default_analysis.</code><code class="sig-name descname">DefaultAnalysis</code><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Analysis functionality associated with an <cite>ExpFragment</cite> to be executed when that
fragment is scanned in a particular way.</p>
<dl class="method">
<dt id="ndscan.experiment.default_analysis.DefaultAnalysis.has_data">
<code class="sig-name descname">has_data</code><span class="sig-paren">(</span><em class="sig-param">scanned_axes: List[Tuple[str, str]]</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis.has_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis.has_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the scanned axes contain the data necessary for this analysis
to be applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scanned_axes</strong> – A list of axis identities, i.e. <code class="docutils literal notranslate"><span class="pre">(fqn,</span> <span class="pre">path_spec)</span></code>
tuples, being scanned over. This is the correct concept of identity to use
(rather than e.g. directly parameter handles), as an analysis typically
doesn’t care whether a parameter was for instance scanned via the path of
the particular handle given or a wildcard path spec.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether this analysis applies or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.default_analysis.DefaultAnalysis.describe_online_analyses">
<code class="sig-name descname">describe_online_analyses</code><span class="sig-paren">(</span><em class="sig-param">context: ndscan.experiment.default_analysis.AnnotationContext</em><span class="sig-paren">)</span> &#x2192; Tuple[List[Dict[str, Any]], Dict[str, Dict[str, Any]]]<a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis.describe_online_analyses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis.describe_online_analyses" title="Permalink to this definition">¶</a></dt>
<dd><p>Exceute analysis and serialise information about resulting annotations and
online analyses to stringly typed metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>context</strong> – The AnnotationContext to use to describe the coordinate axes/
result channels in the resulting metadata.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of string dictionary representations for annotations and
online analyses.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.default_analysis.DefaultAnalysis.execute">
<code class="sig-name descname">execute</code><span class="sig-paren">(</span><em class="sig-param">axis_data: Dict[Tuple[str, str], list], result_data: Dict[ndscan.experiment.result_channels.ResultChannel, list], context: ndscan.experiment.default_analysis.AnnotationContext</em><span class="sig-paren">)</span> &#x2192; List[Dict[str, Any]]<a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis.execute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Exceute analysis and serialise information about resulting annotations to
stringly typed metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>context</strong> – The AnnotationContext to use to describe the coordinate axes/
result channels in the resulting metadata.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of string dictionary representations for the resulting
annotations, if any.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.default_analysis.CustomAnalysis">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.default_analysis.</code><code class="sig-name descname">CustomAnalysis</code><span class="sig-paren">(</span><em class="sig-param">required_axes: Iterable[ndscan.experiment.parameters.ParamHandle], analyze_fn: Callable[[Dict[ndscan.experiment.parameters.ParamHandle, list], Dict[ndscan.experiment.result_channels.ResultChannel, list]], List[ndscan.experiment.default_analysis.Annotation]]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#CustomAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.CustomAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultAnalysis</span></code></a> that executes a user-defined analysis function in the
<cite>execute()</cite> step.</p>
<p>No analysis is run online.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>required_axes</strong> – List of parameters (given by their <code class="xref py py-class docutils literal notranslate"><span class="pre">ParamHandle</span></code>s)
required to be scanend for the analysis to be applicable.</p></li>
<li><p><strong>analyze_fn</strong> – The function to invoke in the analysis step. It is passed two
dictionaries giving list of axis/result channel values for each point of the
scan to analyse. The function can return a list of <a class="reference internal" href="#ndscan.experiment.default_analysis.Annotation" title="ndscan.experiment.default_analysis.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a>s to be
broadcast.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.default_analysis.OnlineFit">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.default_analysis.</code><code class="sig-name descname">OnlineFit</code><span class="sig-paren">(</span><em class="sig-param">fit_type: str, data: Dict[str, Union[ndscan.experiment.parameters.ParamHandle, ndscan.experiment.result_channels.ResultChannel]], annotations: Union[None, Dict[str, Dict[str, Any]]] = None, analysis_identifier: str = None, constants: Dict[str, Any] = {}, initial_values: Dict[str, Any] = {}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#OnlineFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.OnlineFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes an automatically executed fit for a given combination of scan axes
and result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_type</strong> – Fitting procedure name, per <code class="xref py py-data docutils literal notranslate"><span class="pre">FIT_OBJECTS</span></code>.</p></li>
<li><p><strong>data</strong> – Maps fit data axis names (<code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>) to parameter handles or
result channels that supply the respective data.</p></li>
<li><p><strong>annotations</strong> – Any points of interest to highlight in the fit results,
given in the form of a dictionary mapping (arbitrary) identifiers to
dictionaries mapping coordinate names to fit result names. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT_FIT_ANNOTATIONS</span></code> will be queried.</p></li>
<li><p><strong>analysis_identifier</strong> – Optional explicit name to use for online analysis.
Defaults to <code class="docutils literal notranslate"><span class="pre">fit_&lt;fit_type&gt;</span></code>, but can be set explicitly to allow more than one
fit of a given type at a time.</p></li>
<li><p><strong>constants</strong> – Specifies parameters to be held constant during the fit. This is
a dictionary mapping fit parameter names to the respective constant values,
forwarded to <code class="xref py py-meth docutils literal notranslate"><span class="pre">oitg.fitting.FitBase.FitBase.fit()</span></code>.</p></li>
<li><p><strong>initial_values</strong> – Specifies initial values for the fit parameters. This is
a dictionary mapping fit parameter names to the respective values, forwarded to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">oitg.fitting.FitBase.FitBase.fit()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ndscan.experiment.scan_runner">
<span id="ndscan-experiment-scan-runner-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.scan_runner" title="ndscan.experiment.scan_runner"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_runner</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.scan_runner" title="Permalink to this headline">¶</a></h3>
<p>Generic scanning loop.</p>
<p>While <a class="reference internal" href="#module-ndscan.experiment.scan_generator" title="ndscan.experiment.scan_generator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scan_generator</span></code></a> describes a scan to be run in the abstract, this module
contains the implementation to actually execute one within an ARTIQ experiment. This
will likely be used by end users via
<a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="ndscan.experiment.entry_point.FragmentScanExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">FragmentScanExperiment</span></code></a> or subscans.</p>
<dl class="exception">
<dt id="ndscan.experiment.scan_runner.ScanFinished">
<em class="property">exception </em><code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">ScanFinished</code><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanFinished"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanFinished" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally to signal that a scan has been successfully completed (points
exhausted).</p>
<p>This is a kludge to work around a bug where tuples of empty lists crash the ARTIQ
RPC code (kernel aborts), and should never be visible to the user.</p>
</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_runner.ScanAxis">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">ScanAxis</code><span class="sig-paren">(</span><em class="sig-param">param_schema: Dict[str, Any], path: str, param_store: ndscan.experiment.parameters.ParamStore</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanAxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes a single axis that is being scanned.</p>
<p>Apart from the metadata, this also includes the necessary information to execute the
scan at runtime; i.e. the <code class="xref py py-class docutils literal notranslate"><span class="pre">ParamStore</span></code> to modify in order to set the
parameter.</p>
</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_runner.ScanSpec">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">ScanSpec</code><span class="sig-paren">(</span><em class="sig-param">axes: List[ndscan.experiment.scan_runner.ScanAxis], generators: List[ndscan.experiment.scan_generator.ScanGenerator], options: ndscan.experiment.scan_generator.ScanOptions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes a single scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> – The list of parameters that are scanned.</p></li>
<li><p><strong>generators</strong> – Generators that give the points for each of the specified axes.</p></li>
<li><p><strong>options</strong> – Applicable <a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions" title="ndscan.experiment.scan_generator.ScanOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScanOptions</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="ndscan.experiment.scan_runner.NUM_TOLERATED_UNDERFLOWS_PER_POINT">
<code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">NUM_TOLERATED_UNDERFLOWS_PER_POINT</code><em class="property"> = 3</em><a class="headerlink" href="#ndscan.experiment.scan_runner.NUM_TOLERATED_UNDERFLOWS_PER_POINT" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of RTIOUnderflows to tolerate per scan point (by simply trying again) before
giving up.</p>
</dd></dl>

<dl class="data">
<dt id="ndscan.experiment.scan_runner.NUM_TOLERATED_TRANSITORY_ERRORS_PER_POINT">
<code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">NUM_TOLERATED_TRANSITORY_ERRORS_PER_POINT</code><em class="property"> = 10</em><a class="headerlink" href="#ndscan.experiment.scan_runner.NUM_TOLERATED_TRANSITORY_ERRORS_PER_POINT" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of transitory errors to tolerate per scan point (by simply trying again)
before giving up.</p>
</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.scan_runner.ScanRunner">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">ScanRunner</code><span class="sig-paren">(</span><em class="sig-param">managers_or_parent</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanRunner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the actual loop that executes an <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> for a specified list
of scan axes (on either the host or core device, as appropriate).</p>
<p>Integrates with the ARTIQ scheduler to pause/terminate execution as requested.</p>
<p>Conceptually, this is only a single function (<code class="docutils literal notranslate"><span class="pre">run()</span></code>), but is wrapped in a class
to follow the idiomatic ARTIQ kernel/<code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> integration style.</p>
<dl class="method">
<dt id="ndscan.experiment.scan_runner.ScanRunner.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">fragment: ndscan.experiment.fragment.ExpFragment, spec: ndscan.experiment.scan_runner.ScanSpec, axis_sinks: List[ndscan.experiment.result_channels.ResultSink]</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanRunner.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a scan of the given fragment, with axes as specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> – The fragment to iterate.</p></li>
<li><p><strong>options</strong> – The options for the scan generator.</p></li>
<li><p><strong>axis_sinks</strong> – A list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultSink</span></code> instances to push the
coordinates for each scan point to, matching <code class="docutils literal notranslate"><span class="pre">scan.axes</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ndscan.experiment.scan_runner.filter_default_analyses">
<code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">filter_default_analyses</code><span class="sig-paren">(</span><em class="sig-param">fragment: ndscan.experiment.fragment.ExpFragment</em>, <em class="sig-param">spec: ndscan.experiment.scan_runner.ScanSpec</em><span class="sig-paren">)</span> &#x2192; List[ndscan.experiment.default_analysis.DefaultAnalysis]<a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#filter_default_analyses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.filter_default_analyses" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the default analyses of the given fragment that can be executed for the
given scan spec.</p>
</dd></dl>

<dl class="function">
<dt id="ndscan.experiment.scan_runner.describe_scan">
<code class="sig-prename descclassname">ndscan.experiment.scan_runner.</code><code class="sig-name descname">describe_scan</code><span class="sig-paren">(</span><em class="sig-param">spec: ndscan.experiment.scan_runner.ScanSpec, fragment: ndscan.experiment.fragment.ExpFragment, short_result_names: Dict[ndscan.experiment.result_channels.ResultChannel, str]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#describe_scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.describe_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return metadata for the given spec in stringly typed dictionary form, executing
any default analyses as necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – <a class="reference internal" href="#ndscan.experiment.scan_runner.ScanSpec" title="ndscan.experiment.scan_runner.ScanSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScanSpec</span></code></a> describing the scan.</p></li>
<li><p><strong>fragment</strong> – Fragment being scanned.</p></li>
<li><p><strong>short_result_names</strong> – Map from result channel objects to shortened names.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="experiment-entry-points">
<h2>Experiment entry points<a class="headerlink" href="#experiment-entry-points" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-ndscan.experiment.entry_point">
<span id="ndscan-experiment-entry-point-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.entry_point" title="ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.entry_point" title="Permalink to this headline">¶</a></h3>
<p>Top-level functions for launching <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>s and their scans from the rest
of the ARTIQ <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> universe.</p>
<p>The two main entry points into the <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> universe are</p>
<blockquote>
<div><ul class="simple">
<li><p>scans (with axes and overrides set from the dashboard UI) via
<a class="reference internal" href="#ndscan.experiment.entry_point.make_fragment_scan_exp" title="ndscan.experiment.entry_point.make_fragment_scan_exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_fragment_scan_exp()</span></code></a>, and</p></li>
<li><p>manually launched fragments from vanilla ARTIQ <code class="docutils literal notranslate"><span class="pre">EnvExperiment</span></code>s using
<a class="reference internal" href="#ndscan.experiment.entry_point.run_fragment_once" title="ndscan.experiment.entry_point.run_fragment_once"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_fragment_once()</span></code></a> or <a class="reference internal" href="#ndscan.experiment.entry_point.create_and_run_fragment_once" title="ndscan.experiment.entry_point.create_and_run_fragment_once"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_and_run_fragment_once()</span></code></a>.</p></li>
</ul>
</div></blockquote>
<dl class="function">
<dt id="ndscan.experiment.entry_point.make_fragment_scan_exp">
<code class="sig-prename descclassname">ndscan.experiment.entry_point.</code><code class="sig-name descname">make_fragment_scan_exp</code><span class="sig-paren">(</span><em class="sig-param">fragment_class: Type[ndscan.experiment.fragment.ExpFragment]</em><span class="sig-paren">)</span> &#x2192; Type[ndscan.experiment.entry_point.FragmentScanExperiment]<a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#make_fragment_scan_exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.make_fragment_scan_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="ndscan.experiment.entry_point.FragmentScanExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">FragmentScanExperiment</span></code></a> subclass that scans the given
<a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>, ready to be picked up by the ARTIQ explorer/…</p>
<p>This is the default way of creating scan experiments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyExpFragment</span><span class="p">(</span><span class="n">ExpFragment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>

    <span class="k">def</span> <span class="nf">run_once</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>

<span class="n">MyExpFragmentScan</span> <span class="o">=</span> <span class="n">make_fragment_scan_exp</span><span class="p">(</span><span class="n">MyExpFragment</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.entry_point.FragmentScanExperiment">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.entry_point.</code><code class="sig-name descname">FragmentScanExperiment</code><span class="sig-paren">(</span><em class="sig-param">managers_or_parent</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements possibly (trivial) scans of an <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>, with overrides
and scan axes as specified by the <code class="xref py py-data docutils literal notranslate"><span class="pre">PARAMS_ARG_KEY</span></code> dataset, and result
channels being broadcasted to datasets.</p>
<p>See <a class="reference internal" href="#ndscan.experiment.entry_point.make_fragment_scan_exp" title="ndscan.experiment.entry_point.make_fragment_scan_exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_fragment_scan_exp()</span></code></a> for a convenience method to create subclasses for
a specific <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>.</p>
<dl class="method">
<dt id="ndscan.experiment.entry_point.FragmentScanExperiment.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">fragment_init: Callable[ndscan.experiment.fragment.ExpFragment]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.build" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fragment_init</strong> – Callable to create the top-level <code class="xref py py-meth docutils literal notranslate"><span class="pre">ExpFragment()</span></code>
instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.entry_point.FragmentScanExperiment.prepare">
<code class="sig-name descname">prepare</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect parameters to set from both scan axes and simple overrides, and
initialise result channels.</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.entry_point.FragmentScanExperiment.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the (possibly trivial) scan.</p>
</dd></dl>

<dl class="method">
<dt id="ndscan.experiment.entry_point.FragmentScanExperiment.analyze">
<code class="sig-name descname">analyze</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.analyze"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.analyze" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry point for analyzing the results of the experiment.</p>
<p>This method may be overloaded by the user to implement the analysis
phase of the experiment, for example fitting curves.</p>
<p>Splitting this phase from <a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment.run" title="ndscan.experiment.entry_point.FragmentScanExperiment.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> enables tweaking the analysis
algorithm on pre-existing data, and CPU-bound analyses to be run
overlapped with the next experiment in a pipelined manner.</p>
<p>This method must not interact with the hardware.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ndscan.experiment.entry_point.ScanSpecError">
<em class="property">class </em><code class="sig-prename descclassname">ndscan.experiment.entry_point.</code><code class="sig-name descname">ScanSpecError</code><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#ScanSpecError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.ScanSpecError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when the scan specification passed in <code class="xref py py-data docutils literal notranslate"><span class="pre">PARAMS_ARG_KEY</span></code> is not valid
for the given fragment.</p>
</dd></dl>

<dl class="function">
<dt id="ndscan.experiment.entry_point.run_fragment_once">
<code class="sig-prename descclassname">ndscan.experiment.entry_point.</code><code class="sig-name descname">run_fragment_once</code><span class="sig-paren">(</span><em class="sig-param">fragment: ndscan.experiment.fragment.ExpFragment</em><span class="sig-paren">)</span> &#x2192; Dict[ndscan.experiment.result_channels.ResultChannel, Any]<a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#run_fragment_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.run_fragment_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the passed fragment and run it once, capturing and returning the
values from any result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary mapping <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultChannel</span></code> instances to their values
(or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not pushed to).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ndscan.experiment.entry_point.create_and_run_fragment_once">
<code class="sig-prename descclassname">ndscan.experiment.entry_point.</code><code class="sig-name descname">create_and_run_fragment_once</code><span class="sig-paren">(</span><em class="sig-param">env: artiq.language.environment.HasEnvironment, fragment_class: Type[ndscan.experiment.fragment.ExpFragment], *args, **kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#create_and_run_fragment_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ndscan.experiment.entry_point.create_and_run_fragment_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of the passed <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> type and runs it once,
returning the values pushed to any result channels.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyExpFragment</span><span class="p">(</span><span class="n">ExpFragment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_result</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_once</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>

<span class="k">class</span> <span class="nc">MyEnvExperiment</span><span class="p">(</span><span class="n">EnvExperiment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">create_and_run_once</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MyExpFragment</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – The <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> to use.</p></li>
<li><p><strong>fragment_class</strong> – The <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> class to instantiate.</p></li>
<li><p><strong>args</strong> – Any arguments to forward to <code class="docutils literal notranslate"><span class="pre">build_fragment()</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any keyword arguments to forward to <code class="docutils literal notranslate"><span class="pre">build_fragment()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary mapping result channel names to their values (or <code class="docutils literal notranslate"><span class="pre">None</span></code> if
not pushed to).</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="ndscan" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, David Nadlinger

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>