<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ndscan.experiment API &mdash; ndscan  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="canonical" href="https://oxfordiontrapgroup.github.io/ndscan/apidocs.html"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coding conventions" href="coding-conventions.html" />
    <link rel="prev" title="ndscan" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ndscan
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ndscan.experiment API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fragments">Fragments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.fragment"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.fragment</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment"><code class="docutils literal notranslate"><span class="pre">Fragment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment"><code class="docutils literal notranslate"><span class="pre">ExpFragment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.fragment.AggregateExpFragment"><code class="docutils literal notranslate"><span class="pre">AggregateExpFragment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.fragment.TransitoryError"><code class="docutils literal notranslate"><span class="pre">TransitoryError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.fragment.RestartKernelTransitoryError"><code class="docutils literal notranslate"><span class="pre">RestartKernelTransitoryError</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.parameters</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.result_channels"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.result_channels</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.SingleUseSink"><code class="docutils literal notranslate"><span class="pre">SingleUseSink</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.LastValueSink"><code class="docutils literal notranslate"><span class="pre">LastValueSink</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.ArraySink"><code class="docutils literal notranslate"><span class="pre">ArraySink</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.ScalarDatasetSink"><code class="docutils literal notranslate"><span class="pre">ScalarDatasetSink</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel"><code class="docutils literal notranslate"><span class="pre">ResultChannel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.NumericChannel"><code class="docutils literal notranslate"><span class="pre">NumericChannel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.FloatChannel"><code class="docutils literal notranslate"><span class="pre">FloatChannel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.IntChannel"><code class="docutils literal notranslate"><span class="pre">IntChannel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.result_channels.OpaqueChannel"><code class="docutils literal notranslate"><span class="pre">OpaqueChannel</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scans">Scans</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.scan_generator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_generator</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanGenerator"><code class="docutils literal notranslate"><span class="pre">ScanGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_generator.RefiningGenerator"><code class="docutils literal notranslate"><span class="pre">RefiningGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_generator.LinearGenerator"><code class="docutils literal notranslate"><span class="pre">LinearGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_generator.ListGenerator"><code class="docutils literal notranslate"><span class="pre">ListGenerator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions"><code class="docutils literal notranslate"><span class="pre">ScanOptions</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.subscan"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.subscan</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.subscan.setattr_subscan"><code class="docutils literal notranslate"><span class="pre">setattr_subscan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.subscan.Subscan"><code class="docutils literal notranslate"><span class="pre">Subscan</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.subscan.SubscanExpFragment"><code class="docutils literal notranslate"><span class="pre">SubscanExpFragment</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.default_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.default_analysis</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.default_analysis.Annotation"><code class="docutils literal notranslate"><span class="pre">Annotation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis"><code class="docutils literal notranslate"><span class="pre">DefaultAnalysis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.default_analysis.CustomAnalysis"><code class="docutils literal notranslate"><span class="pre">CustomAnalysis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.default_analysis.OnlineFit"><code class="docutils literal notranslate"><span class="pre">OnlineFit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper"><code class="docutils literal notranslate"><span class="pre">ResultPrefixAnalysisWrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.scan_runner"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_runner</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanAxis"><code class="docutils literal notranslate"><span class="pre">ScanAxis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanSpec"><code class="docutils literal notranslate"><span class="pre">ScanSpec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanRunner"><code class="docutils literal notranslate"><span class="pre">ScanRunner</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.match_default_analysis"><code class="docutils literal notranslate"><span class="pre">match_default_analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.filter_default_analyses"><code class="docutils literal notranslate"><span class="pre">filter_default_analyses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.describe_scan"><code class="docutils literal notranslate"><span class="pre">describe_scan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.scan_runner.describe_analyses"><code class="docutils literal notranslate"><span class="pre">describe_analyses()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#experiment-entry-points">Experiment entry points</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code> module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.entry_point.make_fragment_scan_exp"><code class="docutils literal notranslate"><span class="pre">make_fragment_scan_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment"><code class="docutils literal notranslate"><span class="pre">FragmentScanExperiment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.entry_point.ScanSpecError"><code class="docutils literal notranslate"><span class="pre">ScanSpecError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.entry_point.run_fragment_once"><code class="docutils literal notranslate"><span class="pre">run_fragment_once()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndscan.experiment.entry_point.create_and_run_fragment_once"><code class="docutils literal notranslate"><span class="pre">create_and_run_fragment_once()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#module-ndscan.results">ndscan.results API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-ndscan.results.arguments"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.results.arguments</span></code> module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.arguments.extract_param_schema"><code class="docutils literal notranslate"><span class="pre">extract_param_schema()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.arguments.dump_overrides"><code class="docutils literal notranslate"><span class="pre">dump_overrides()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.arguments.dump_scan"><code class="docutils literal notranslate"><span class="pre">dump_scan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.arguments.summarise"><code class="docutils literal notranslate"><span class="pre">summarise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ndscan.results.pyplot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.results.pyplot</span></code> module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.pyplot.make_default_plot"><code class="docutils literal notranslate"><span class="pre">make_default_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.pyplot.auto_plot"><code class="docutils literal notranslate"><span class="pre">auto_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ndscan.results.tools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.results.tools</span></code> module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ndscan.results.tools.find_ndscan_roots"><code class="docutils literal notranslate"><span class="pre">find_ndscan_roots()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coding-conventions.html">Coding conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="design-retrospective.html">Design retrospective</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ndscan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ndscan.experiment API</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/OxfordIonTrapGroup/ndscan/blob/master/docs/apidocs.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ndscan.experiment">
<span id="ndscan-experiment-api"></span><h1>ndscan.experiment API<a class="headerlink" href="#module-ndscan.experiment" title="Link to this heading"></a></h1>
<p>Experiment-side <code class="docutils literal notranslate"><span class="pre">ndscan</span></code> interface</p>
<p><code class="docutils literal notranslate"><span class="pre">ndscan.experiment</span></code> contains the code for implementing the <code class="docutils literal notranslate"><span class="pre">ndscan</span></code> primitives from
ARTIQ experiments (as opposed to submitting the experiments with certain parameters, or
later analysing and plotting the generated data).</p>
<p>The top-level module provides a single convenient way to import commonly used symbols
from experiment client code, like <code class="docutils literal notranslate"><span class="pre">artiq.experiment</span></code> does for upstream ARTIQ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import commonly used symbols, including all of artiq.experiment:</span>
<span class="kn">from</span> <span class="nn">ndscan.experiment</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<section id="fragments">
<h2>Fragments<a class="headerlink" href="#fragments" title="Link to this heading"></a></h2>
<section id="module-ndscan.experiment.fragment">
<span id="ndscan-experiment-fragment-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.fragment" title="ndscan.experiment.fragment"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.fragment</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.fragment" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.fragment.</span></span><span class="sig-name descname"><span class="pre">Fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment" title="Link to this definition"></a></dt>
<dd><p>Main building block.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.build" title="Link to this definition"></a></dt>
<dd><p>Initialise this fragment instance; called from the <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>
constructor.</p>
<p>This sets up the machinery for registering parameters and result channels with
the fragment tree, and then calls <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> to actually perform the
fragment-specific setup. This method should not typically be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment_path</strong> – Full path of the fragment, as a list starting from the
root. For instance, <code class="docutils literal notranslate"><span class="pre">[]</span></code> for the top-level fragment, or <code class="docutils literal notranslate"><span class="pre">[&quot;foo&quot;,</span> <span class="pre">&quot;bar&quot;]</span></code>
for a subfragment created by <code class="docutils literal notranslate"><span class="pre">setattr_fragment(&quot;bar&quot;,</span> <span class="pre">…)</span></code> in a fragment
created by <code class="docutils literal notranslate"><span class="pre">setattr_fragment(&quot;foo&quot;,</span> <span class="pre">…)</span></code>.</p></li>
<li><p><strong>args</strong> – Arguments to be forwarded to <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be forwarded to <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.host_setup">
<span class="sig-name descname"><span class="pre">host_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.host_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.host_setup" title="Link to this definition"></a></dt>
<dd><p>Perform host-side initialisation.</p>
<p>For fragments used as part of an on-core-device scan (i.e. with an <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code>
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>/<code class="xref py py-meth docutils literal notranslate"><span class="pre">run_once()</span></code>), this will be called on the host,
immediately before the top-level kernel function is entered.</p>
<p>Typical uses include initialising member variables for latter use in <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code>
functions, and setting parameters not modifiable from kernels (e.g. because
modifying a parameter requires launching another experiment to effect the
change).</p>
<p>The default implementation calls <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a> recursively on all
subfragments. When overriding it in a fragment with subfragments, consider
forwarding to the default implementation (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">host_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">initialise_some_things</span><span class="p">()</span>

    <span class="c1"># To continue to initialise all subfragments, invoke the parent</span>
    <span class="c1"># implementation:</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">host_setup</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.device_setup">
<span class="sig-name descname"><span class="pre">device_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_setup" title="Link to this definition"></a></dt>
<dd><p>Perform core-device-side initialisation.</p>
<p>A typical implementation will make sure that any hardware state represented by
the fragment (e.g. some DAC voltages, DDS frequencies, etc.) is updated to
match the fragment parameters.</p>
<p>If the fragment is used as part of a scan, <code class="docutils literal notranslate"><span class="pre">device_setup()</span></code> will be called
immediately before each <code class="docutils literal notranslate"><span class="pre">ExpFragment.run_once()</span></code> call (and, for on-core-device
scans, from within the same kernel).</p>
<p>The default implementation calls <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup_subfragments" title="ndscan.experiment.fragment.Fragment.device_setup_subfragments"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup_subfragments()</span></code></a> to initialise
all subfragments. When overriding it, consider forwarding to it too unless a
special initialisation order, etc. is required (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@kernel</span>
<span class="k">def</span> <span class="nf">device_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device_setup_subfragments</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">break_realtime</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_frequency</span><span class="o">.</span><span class="n">changed_after_use</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_dds</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_frequency</span><span class="o">.</span><span class="n">use</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">my_ttl</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.device_setup_subfragments">
<span class="sig-name descname"><span class="pre">device_setup_subfragments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_setup_subfragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_setup_subfragments" title="Link to this definition"></a></dt>
<dd><p>Call <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a> on all subfragments.</p>
<p>This is the default implementation for <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>, but is kept
separate so that subfragments overriding <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a> can still access
it. (ARTIQ Python does not support calling superclass implementations in a
polymorphic way – <code class="docutils literal notranslate"><span class="pre">Fragment.device_setup(self)</span></code> could be used from one
subclass, but would cause the argument type to be inferred as that subclass.
Only direct member function calls are special-cased to be generic on the
<cite>self</cite> type.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.host_cleanup">
<span class="sig-name descname"><span class="pre">host_cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.host_cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.host_cleanup" title="Link to this definition"></a></dt>
<dd><p>Perform host-side cleanup after an experiment has been run.</p>
<p>This is the equivalent of <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a> to be run <em>after</em> the main
experiment. It is executed on the host after the top-level kernel function, if
any, has been left, as control is about to leave the experiment (whether because
a scan has been finished, or the experiment is about to be paused for a
higher-priority run to be scheduled in.</p>
<p>Typically, fragments should strive to completely initialise the state of all
their dependencies for robustness. As such, manual cleanup should almost never
be necessary.</p>
<p>By default, calls <cite>host_cleanup()</cite> on all subfragments, in reverse
initialisation order. The default implementation catches all exceptions thrown
from cleanups and converts them into log messages to ensure no cleanups are
skipped. As there will be no exception propagating to the caller to mark the
experiment as failed, failing cleanups should be avoided.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">host_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tear_down_some_things</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">host_setup</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.device_cleanup">
<span class="sig-name descname"><span class="pre">device_cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="Link to this definition"></a></dt>
<dd><p>Perform core-device-side teardown.</p>
<p>This is the equivalent of <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>, run after the main experiment.
It is executed on the core device every time the top-level kernel is about to be
left.</p>
<p>Thus, if the fragment is used as part of a scan, <code class="docutils literal notranslate"><span class="pre">device_cleanup()</span></code> will be
typically be called once at the end of each scan (while <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_setup" title="ndscan.experiment.fragment.Fragment.device_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code></a>
will be called once per scan point).</p>
<p>The default implementation calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">device_clean_subfragments()</span></code> to clean up
all subfragments in reverse initialisation order. When overriding it, consider
forwarding to it too (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@kernel</span>
<span class="k">def</span> <span class="nf">device_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">clean_up_some_things</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device_cleanup_subfragments</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.device_cleanup_subfragments">
<span class="sig-name descname"><span class="pre">device_cleanup_subfragments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.device_cleanup_subfragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.device_cleanup_subfragments" title="Link to this definition"></a></dt>
<dd><p>Call <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a> on all subfragments.</p>
<p>This is the default implementation for <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a>, but is kept
separate so that subfragments overriding <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a> can still access
it.</p>
<p><a class="reference internal" href="#ndscan.experiment.fragment.Fragment.device_cleanup" title="ndscan.experiment.fragment.Fragment.device_cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_cleanup()</span></code></a> is invoked on all subfragments in reverse initialisation
order. To ensure no cleanups are skipped, any exceptions thrown from cleanups
are caught and converted into log messages. As there will be no exception
propagating to the caller to mark the experiment as failed, failing cleanups
should be avoided.</p>
<p>(ARTIQ Python does not support calling superclass implementations in a
polymorphic way – <code class="docutils literal notranslate"><span class="pre">Fragment.device_setup(self)</span></code> could be used from one
concrete fragment in the whole project, but would cause the argument type to be
inferred as that subclass. Only direct member function calls are special-cased
to be generic on the <cite>self</cite> type.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.build_fragment">
<span class="sig-name descname"><span class="pre">build_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.build_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="Link to this definition"></a></dt>
<dd><p>Initialise this fragment, building up the hierarchy of subfragments,
parameters and result channels.</p>
<p>This is where any constructor-type initialisation should take place, similar to
the role <code class="docutils literal notranslate"><span class="pre">build()</span></code> has for a bare <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>.</p>
<p>While this method executes, the various <code class="docutils literal notranslate"><span class="pre">setattr_*()</span></code> functions can be used
to create subfragments, parameters, and result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Any extra arguments that were passed to the <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>
constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments that were passed to the
<code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> constructor.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.setattr_fragment">
<span class="sig-name descname"><span class="pre">setattr_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_fragment" title="Link to this definition"></a></dt>
<dd><p>Create a subfragment of the given name and type.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The fragment name; part of the fragment path. Must be a valid
Python identifier; the fragment will be accessible as <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>fragment_class</strong> – The type of the subfragment to instantiate.</p></li>
<li><p><strong>args</strong> – Any extra arguments to forward to the subfragment
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> call.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to forward to the subfragment
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a> call.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly created fragment instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.setattr_param">
<span class="sig-name descname"><span class="pre">setattr_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ParamHandle</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_param" title="Link to this definition"></a></dt>
<dd><p>Create a parameter of the given name and type.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The parameter name, to be part of its FQN. Must be a valid Python
identifier; the parameter handle will be accessible as <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>param_class</strong> – The type of parameter to instantiate.</p></li>
<li><p><strong>description</strong> – The human-readable parameter name.</p></li>
<li><p><strong>args</strong> – Any extra arguments to pass to the <code class="docutils literal notranslate"><span class="pre">param_class</span></code> constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to pass to the the <code class="docutils literal notranslate"><span class="pre">param_class</span></code>
constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly created parameter handle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.setattr_param_like">
<span class="sig-name descname"><span class="pre">setattr_param_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_owner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ParamHandle</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_param_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_param_like" title="Link to this definition"></a></dt>
<dd><p>Create a new parameter using an existing parameter as a template.</p>
<p>The newly created parameter will inherent its type, and all the metadata that
is not overridden by the optional keyword arguments, from the template
parameter.</p>
<p>This is often combined with <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.bind_param" title="ndscan.experiment.fragment.Fragment.bind_param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bind_param()</span></code></a> to rebind parameters from one or
more subfragments; see also <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.setattr_param_rebind" title="ndscan.experiment.fragment.Fragment.setattr_param_rebind"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setattr_param_rebind()</span></code></a>, which combines the
two.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The new parameter’s name, to be part of its FQN. Must be a valid
Python identifier; the parameter handle will be accessible as
<code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>original_owner</strong> – The fragment owning the parameter to use as a template.</p></li>
<li><p><strong>original_name</strong> – The name of the parameter to use as a template (i.e.
<code class="docutils literal notranslate"><span class="pre">&lt;original_owner&gt;.&lt;original_name&gt;</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any attributes to override in the template parameter metadata.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly created parameter handle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.setattr_param_rebind">
<span class="sig-name descname"><span class="pre">setattr_param_rebind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_owner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ParamHandle</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_param_rebind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_param_rebind" title="Link to this definition"></a></dt>
<dd><p>Convenience function combining <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.setattr_param_like" title="ndscan.experiment.fragment.Fragment.setattr_param_like"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setattr_param_like()</span></code></a> and
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.bind_param" title="ndscan.experiment.fragment.Fragment.bind_param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bind_param()</span></code></a> to override a subfragment parmeter.</p>
<p>The most common use case for this is to specialise the operation of a generic
subfragment. For example, there might be a fragment <code class="docutils literal notranslate"><span class="pre">Fluoresce</span></code> that drives
a cycling transition in an ion with parameters for intensity and detuning.
Higher-level fragments for Doppler cooling, readout, etc. might then use
<code class="docutils literal notranslate"><span class="pre">Fluoresce</span></code>, rebinding its intensity and detuning parameters to values and
defaults appropriate for those particular tasks.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The parameter name, to be part of its FQN. Must be a valid Python
identifier; the parameter handle will be accessible as <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>original_owner</strong> – The fragment owning the parameter to rebind.</p></li>
<li><p><strong>original_name</strong> – The name of the original parameter (i.e.
<code class="docutils literal notranslate"><span class="pre">&lt;original_owner&gt;.&lt;original_name&gt;</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any attributes to override in the parameter metadata, which
defaults to that of the original parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly created parameter handle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.setattr_result">
<span class="sig-name descname"><span class="pre">setattr_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_class:</span> <span class="pre">type[~ndscan.experiment.result_channels.ResultChannel]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'ndscan.experiment.result_channels.FloatChannel'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.setattr_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.setattr_result" title="Link to this definition"></a></dt>
<dd><p>Create a result channel of the given name and type.</p>
<p>Can only be called during <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The result channel name, to be part of its full path. Must be a
valid Python identifier. The channel instance will be accessible as
<code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code>.</p></li>
<li><p><strong>channel_class</strong> – The type of result channel to instantiate.</p></li>
<li><p><strong>args</strong> – Any extra arguments to pass to the <code class="docutils literal notranslate"><span class="pre">channel_class</span></code> constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to pass to the the <code class="docutils literal notranslate"><span class="pre">channel_class</span></code>
constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly created result channel instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.override_param">
<span class="sig-name descname"><span class="pre">override_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ParamStore</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.override_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.override_param" title="Link to this definition"></a></dt>
<dd><p>Override the parameter with the given name and set it to the provided value.</p>
<p>See <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.bind_param" title="ndscan.experiment.fragment.Fragment.bind_param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bind_param()</span></code></a>, which also overrides the parameter, but sets it to
follow another parameter instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_name</strong> – The name of the parameter.</p></li>
<li><p><strong>initial_value</strong> – The initial value for the parameter. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the
default from the parameter schema is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(param,</span> <span class="pre">store)</span></code> of the parameter metadata and the newly
created <code class="xref py py-class docutils literal notranslate"><span class="pre">ParamStore</span></code> instance that the parameter handles are now
bound to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.bind_param">
<span class="sig-name descname"><span class="pre">bind_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamHandle</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.bind_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.bind_param" title="Link to this definition"></a></dt>
<dd><p>Override the fragment parameter with the given name such that its value
follows that of another parameter.</p>
<p>The most common use case for this is to specialise the operation of a generic
subfragment. For example, there might be a fragment <code class="docutils literal notranslate"><span class="pre">Fluoresce</span></code> that drives
a cycling transition in an ion with parameters for intensity and detuning.
Higher-level fragments for Doppler cooling, readout, etc. might then use
<code class="docutils literal notranslate"><span class="pre">Fluoresce</span></code>, binding its intensity and detuning parameters to values and
defaults appropriate for those particular tasks.</p>
<p>See <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.override_param" title="ndscan.experiment.fragment.Fragment.override_param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">override_param()</span></code></a>, which sets the parameter to a fixed value/store.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_name</strong> – The name of the parameter to be bound (i.e.
<code class="docutils literal notranslate"><span class="pre">self.&lt;param_name&gt;</span></code>). Must be a free parameter of this fragment (not
already bound or overridden).</p></li>
<li><p><strong>source</strong> – The parameter to bind to. Must be a free parameter of its
respective owner.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.detach_fragment">
<span class="sig-name descname"><span class="pre">detach_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.detach_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.detach_fragment" title="Link to this definition"></a></dt>
<dd><p>Detach a subfragment from the execution machinery, causing its setup and
cleanup methods not to be invoked and its result channels not to be collected.</p>
<p>Its parameters will still be available in the global tree as usual, but the
the actual execution can be customised this way, e.g. for the implementation of
subscans.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fragment</strong> – The fragment to detach; must be a direct subfragment of this
fragment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.init_params">
<span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ParamStore</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.init_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.init_params" title="Link to this definition"></a></dt>
<dd><p>Initialise free parameters of this fragment and all its subfragments.</p>
<p>If, for a given parameter, a relevant override is given, the specified
ParamStore is used. Otherwise, the default value is evaluated and a new store
pointing to it created.</p>
<p>This method should be called before any of the fragment’s user-defined functions
are used (but after the constructor -&gt; <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build" title="ndscan.experiment.fragment.Fragment.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code></a> -&gt; :meth`build_fragment()`
has completed). Most likely, the top-level fragment will be called from an
<a class="reference internal" href="#module-ndscan.experiment.entry_point" title="ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code></a>, which already take care of this. In cases
where fragments are used in a different context, for example from a standalone
<code class="docutils literal notranslate"><span class="pre">EnvExperiment</span></code>, this method must be called manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>overrides</strong> – A dictionary mapping parameter FQNs to lists of overrides.
Each override is specified as a tuple <cite>(pathspec, store)</cite> of a path spec and
the store to use for parameters the path of which matches the spec.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.recompute_param_defaults">
<span class="sig-name descname"><span class="pre">recompute_param_defaults</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.recompute_param_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.recompute_param_defaults" title="Link to this definition"></a></dt>
<dd><p>Recompute default values of the parameters of this fragment and all its
subfragments.</p>
<p>For parameters where the default value was previously used, the expression is
evaluated again – thus for instance fetching new dataset values –, and assigned
to the existing parameter store. An informative message is logged if the value
changed, such that changes remain traceable after the fact (e.g. when an
experiment is resumed after a calibration interruption).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.make_namespaced_identifier">
<span class="sig-name descname"><span class="pre">make_namespaced_identifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.make_namespaced_identifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.make_namespaced_identifier" title="Link to this definition"></a></dt>
<dd><p>Mangle passed name and path to this fragment into a string, such that calls
from different fragments give different results for the same name.</p>
<p>This can, for instance, be useful when naming DMA sequences, or interacting with
other kinds of global registries, where multiple fragment instances should not
conflict with each other.</p>
<p>The returned string will consist of characters that are valid Python identifiers
and slashes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.Fragment.get_always_shown_params">
<span class="sig-name descname"><span class="pre">get_always_shown_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#Fragment.get_always_shown_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.Fragment.get_always_shown_params" title="Link to this definition"></a></dt>
<dd><p>Return handles of parameters to always show in user interfaces when this
fragment is the root of the fragment tree (vs. other parameters for which
overrides need to be explicitly added).</p>
<p>This can be overridden in fragment implementations to customise the user
interface; by default, all free parameters are shown in the order they were
created in <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyFragment</span><span class="p">(</span><span class="n">Fragment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_fragment</span><span class="p">(</span><span class="s2">&quot;child&quot;</span><span class="p">,</span> <span class="n">MyChildFragment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_param</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_param</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_param</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_always_shown_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">shown</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_always_shown_params</span><span class="p">()</span>

        <span class="c1"># Don&#39;t show self.bar.</span>
        <span class="n">shown</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bar</span><span class="p">)</span>

        <span class="c1"># Always show an important parameter from a</span>
        <span class="c1"># child fragment.</span>
        <span class="n">shown</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">very_important_param</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">shown</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.ExpFragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.fragment.</span></span><span class="sig-name descname"><span class="pre">ExpFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment" title="Link to this definition"></a></dt>
<dd><p>Fragment that supports the notion of being run to produce results.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.ExpFragment.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment.prepare" title="Link to this definition"></a></dt>
<dd><p>Prepare this instance for execution
(see <code class="docutils literal notranslate"><span class="pre">artiq.language.environment.Experiment.prepare</span></code>).</p>
<p>This is invoked only once per (sub)scan, after <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.build_fragment" title="ndscan.experiment.fragment.Fragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Fragment.build_fragment()</span></code></a>
but before <a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a>. At this point, parameters, datasets and devices
can be accessed, but devices must not yet be.</p>
<p>For top-level scans, this can (and will) be executed in the <cite>prepare</cite> scheduler
pipeline stage.</p>
<p>Unless running in the <cite>prepare</cite> pipeline state is absolutely necessary for
runtime performance, lazily running the requisite initialisation code in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code> is usually preferable, as this naturally composes across the
ndscan fragment tree.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.ExpFragment.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment.run_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment.run_once" title="Link to this definition"></a></dt>
<dd><p>Execute the experiment described by the fragment once with the current
parameters, producing one set of results (if any).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.ExpFragment.get_default_analyses">
<span class="sig-name descname"><span class="pre">get_default_analyses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#ExpFragment.get_default_analyses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.ExpFragment.get_default_analyses" title="Link to this definition"></a></dt>
<dd><p>Return list of <a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultAnalysis</span></code></a> instances describing analyses
(fits, etc.) for this fragment.</p>
<p>Analyses are only run if the fragment is scanned along the axes required for
them to apply.</p>
<p>This is a class method in spirit, and might become one in the future.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.AggregateExpFragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.fragment.</span></span><span class="sig-name descname"><span class="pre">AggregateExpFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#AggregateExpFragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.AggregateExpFragment" title="Link to this definition"></a></dt>
<dd><p>Combines multiple <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>s by executing them one after each other
each time <a class="reference internal" href="#ndscan.experiment.fragment.AggregateExpFragment.run_once" title="ndscan.experiment.fragment.AggregateExpFragment.run_once"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_once()</span></code></a> is called.</p>
<p>To use, derive from the class and, in the subclass <code class="docutils literal notranslate"><span class="pre">build_fragment()</span></code> method
forward to the parent implementation after constructing all the relevant fragments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FooBarAggregate</span><span class="p">(</span><span class="n">AggregateExpFragment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_fragment</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">FooFragment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_fragment</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">BarFragment</span><span class="p">)</span>

        <span class="c1"># Any number of customisations can be made as usual,</span>
        <span class="c1"># e.g. to provide a convenient parameter to scan the</span>
        <span class="c1"># fragments in lockstep:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_param_rebind</span><span class="p">(</span><span class="s2">&quot;freq&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">bind_param</span><span class="p">(</span><span class="s2">&quot;freq&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>

        <span class="c1"># Let AggregateExpFragment default implementations</span>
        <span class="c1"># take care of the rest, e.g. have self.run_once()</span>
        <span class="c1"># call self.foo.run_once(), then self.bar.run_once().</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build_fragment</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bar</span><span class="p">])</span>

<span class="n">ScanFooBarAggregate</span> <span class="o">=</span> <span class="n">make_fragment_scan_exp</span><span class="p">(</span><span class="n">FooBarAggregate</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.AggregateExpFragment.build_fragment">
<span class="sig-name descname"><span class="pre">build_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#AggregateExpFragment.build_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.AggregateExpFragment.build_fragment" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>exp_fragments</strong> – The “child” fragments to execute. The fragments will be
run in the given order. No special treatment is given to the
<code class="docutils literal notranslate"><span class="pre">{host,device}_{setup,cleanup}()</span></code> methods, which will just be executed
through the recursive default implementations unless overridden by the user.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.AggregateExpFragment.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#AggregateExpFragment.run_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.AggregateExpFragment.run_once" title="Link to this definition"></a></dt>
<dd><p>Execute the experiment by forwarding to each child fragment.</p>
<p>Invokes all child fragments in the order they are passed to
<a class="reference internal" href="#ndscan.experiment.fragment.AggregateExpFragment.build_fragment" title="ndscan.experiment.fragment.AggregateExpFragment.build_fragment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_fragment()</span></code></a>. This method can be overridden if more complex behaviour
is desired.</p>
<p>If all child fragments have a <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code> <code class="docutils literal notranslate"><span class="pre">run_once()</span></code>, this is implemented on
the core device as well to avoid costly kernel recompilations in a scan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.AggregateExpFragment.get_always_shown_params">
<span class="sig-name descname"><span class="pre">get_always_shown_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#AggregateExpFragment.get_always_shown_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.AggregateExpFragment.get_always_shown_params" title="Link to this definition"></a></dt>
<dd><p>Collect always-shown params from each child fragment, plus any parameters
directly defined in this fragment as usual.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.AggregateExpFragment.get_default_analyses">
<span class="sig-name descname"><span class="pre">get_default_analyses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#AggregateExpFragment.get_default_analyses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.AggregateExpFragment.get_default_analyses" title="Link to this definition"></a></dt>
<dd><p>Collect default analyses from each child fragment.</p>
<p>The analyses are wrapped in a proxy that prepends any result channel names with
the fragment path to ensure results from different analyses do not collide.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.TransitoryError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.fragment.</span></span><span class="sig-name descname"><span class="pre">TransitoryError</span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#TransitoryError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.TransitoryError" title="Link to this definition"></a></dt>
<dd><p>Transitory error encountered while executing a fragment, which is expected to
clear itself up if it is attempted again without any further changes.</p>
<p>Such errors are never raised by the ndscan infrastructure itself, but can be thrown
from user fragment implementations in response to e.g. some temporary hardware
conditions such as a momentarily insufficient level of laser power.</p>
<p><a class="reference internal" href="#module-ndscan.experiment.entry_point" title="ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code></a>s will attempt to handle transitory errors,
e.g. by retrying execution some amount of times. If fragments are manually executed
from user code, it will often be appropriate to do this as well, unless the user
code base does not use transitory errors at all.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ndscan.experiment.fragment.RestartKernelTransitoryError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.fragment.</span></span><span class="sig-name descname"><span class="pre">RestartKernelTransitoryError</span></span><a class="reference internal" href="_modules/ndscan/experiment/fragment.html#RestartKernelTransitoryError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.fragment.RestartKernelTransitoryError" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#ndscan.experiment.fragment.TransitoryError" title="ndscan.experiment.fragment.TransitoryError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransitoryError</span></code></a> where, as part of recovering from it, the kernel should
be restarted before retrying.</p>
<p>This can be used for cases where remedying the error requires
<a class="reference internal" href="#ndscan.experiment.fragment.Fragment.host_setup" title="ndscan.experiment.fragment.Fragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Fragment.host_setup()</span></code></a> to be run again, such as for cases where the
experiments needs to yield back to the scheduler (e.g. for an ion loss event to be
remedied by a second reloading experiment).</p>
</dd></dl>

</section>
<section id="module-ndscan.experiment.parameters">
<span id="ndscan-experiment-parameters-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.parameters" title="ndscan.experiment.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.parameters</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.parameters" title="Link to this heading"></a></h3>
<p>Fragment-side parameter containers.</p>
</section>
<section id="module-ndscan.experiment.result_channels">
<span id="ndscan-experiment-result-channels-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.result_channels" title="ndscan.experiment.result_channels"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.result_channels</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.result_channels" title="Link to this heading"></a></h3>
<p>Result handling building blocks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.SingleUseSink">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">SingleUseSink</span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#SingleUseSink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.SingleUseSink" title="Link to this definition"></a></dt>
<dd><p>Sink that allows only one value to be pushed (before being cleared).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.SingleUseSink.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#SingleUseSink.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.SingleUseSink.push" title="Link to this definition"></a></dt>
<dd><p>Record a new value.</p>
<p>This should never fail; neither in the sense of raising an exception, nor (for
sinks that record a series of values) in the sense of failing to record the
presence of a value, as code consuming results relies on one <code class="docutils literal notranslate"><span class="pre">push()</span></code> each to
a set of result channels and subsequently sinks representing a single multi-
dimensional data point.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.LastValueSink">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">LastValueSink</span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#LastValueSink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.LastValueSink" title="Link to this definition"></a></dt>
<dd><p>Sink that allows multiple values to be pushed, but retains only the last-pushed
one.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.LastValueSink.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#LastValueSink.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.LastValueSink.push" title="Link to this definition"></a></dt>
<dd><p>Record a new value.</p>
<p>This should never fail; neither in the sense of raising an exception, nor (for
sinks that record a series of values) in the sense of failing to record the
presence of a value, as code consuming results relies on one <code class="docutils literal notranslate"><span class="pre">push()</span></code> each to
a set of result channels and subsequently sinks representing a single multi-
dimensional data point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.LastValueSink.get_last">
<span class="sig-name descname"><span class="pre">get_last</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#LastValueSink.get_last"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.LastValueSink.get_last" title="Link to this definition"></a></dt>
<dd><p>Return the last-pushed value, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if none yet.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ArraySink">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">ArraySink</span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink" title="Link to this definition"></a></dt>
<dd><p>Sink that stores all pushed values in a list.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ArraySink.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink.push" title="Link to this definition"></a></dt>
<dd><p>Record a new value.</p>
<p>This should never fail; neither in the sense of raising an exception, nor (for
sinks that record a series of values) in the sense of failing to record the
presence of a value, as code consuming results relies on one <code class="docutils literal notranslate"><span class="pre">push()</span></code> each to
a set of result channels and subsequently sinks representing a single multi-
dimensional data point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ArraySink.get_all">
<span class="sig-name descname"><span class="pre">get_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink.get_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink.get_all" title="Link to this definition"></a></dt>
<dd><p>Return a list of all previously pushed values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ArraySink.get_last">
<span class="sig-name descname"><span class="pre">get_last</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink.get_last"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink.get_last" title="Link to this definition"></a></dt>
<dd><p>Return the last-pushed value, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if none yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ArraySink.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ArraySink.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ArraySink.clear" title="Link to this definition"></a></dt>
<dd><p>Clear the list of previously pushed values.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ScalarDatasetSink">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">ScalarDatasetSink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink" title="Link to this definition"></a></dt>
<dd><p>Sink that writes pushed results to a dataset, overwriting its previous value
if any.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ScalarDatasetSink.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadcast</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink.build" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – Dataset key to write the value to.</p></li>
<li><p><strong>broadcast</strong> – Whether to set the dataset in broadcast mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ScalarDatasetSink.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink.push" title="Link to this definition"></a></dt>
<dd><p>Record a new value.</p>
<p>This should never fail; neither in the sense of raising an exception, nor (for
sinks that record a series of values) in the sense of failing to record the
presence of a value, as code consuming results relies on one <code class="docutils literal notranslate"><span class="pre">push()</span></code> each to
a set of result channels and subsequently sinks representing a single multi-
dimensional data point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ScalarDatasetSink.get_last">
<span class="sig-name descname"><span class="pre">get_last</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ScalarDatasetSink.get_last"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ScalarDatasetSink.get_last" title="Link to this definition"></a></dt>
<dd><p>Return the last pushed value, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if none yet.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ResultChannel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">ResultChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_hints:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_by_default:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ResultChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ResultChannel" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – The path to the channel in the fragment tree (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;readout/p&quot;</span></code>).</p></li>
<li><p><strong>description</strong> – A human-readable name of the channel. If non-empty, will be
preferred to the path to e.g. display in plot axis labels.</p></li>
<li><p><strong>display_hints</strong> – <p>A dictionary of additional settings that can be used to
indicate how to best display results to the user (see above):</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 29%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coordinate_type</span></code></p></td>
<td><p>String describing the coordinate type.</p></td>
<td><p>For numeric channels, describes the coordinate system for the resulting
values, which can be used to select a more appropriate visualisation than
the default, which corresponds to straightforward linear coordinates
(optionally bounded if <code class="docutils literal notranslate"><span class="pre">min</span></code>/<code class="docutils literal notranslate"><span class="pre">max</span></code> are set). Currently implemented:
<code class="docutils literal notranslate"><span class="pre">cyclic</span></code>, where the values are cyclical between <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>
(e.g. a phase between 0 and 2π).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">error_bar_for</span></code></p></td>
<td><p>Path of the linked result channel</p></td>
<td><p>Indicates that this (numeric) result channel should be used to determine
the size of the error bars for the given other channel.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">priority</span></code></p></td>
<td><p>Integer</p></td>
<td><p>Specifies a sort order between result channels, used e.g. to control the
way various axes are laid out. Channels are sorted from highest to lowest
priority (default: 0). Channels with negative priorities are not displayed
by default unless explicitly enabled.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">share_axis_with</span></code></p></td>
<td><p>Path of the linked result channel</p></td>
<td><p>Indicates that this result channel should be drawn on the same plot axis
as the given other channel.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">share_pane_with</span></code></p></td>
<td><p>Path of the linked result channel</p></td>
<td><p>Indicates that this result channel should be drawn on the same plot pane
as the given other channel (but e.g. on its own y axis). This restores
the behaviour of previous <code class="docutils literal notranslate"><span class="pre">ndscan</span></code> versions, where all axes used to be
shown in a single plot pane.</p></td>
</tr>
</tbody>
</table>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ResultChannel.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ResultChannel.describe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ResultChannel.describe" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ResultChannel.is_muted">
<span class="sig-name descname"><span class="pre">is_muted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ResultChannel.is_muted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ResultChannel.is_muted" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ResultChannel.set_sink">
<span class="sig-name descname"><span class="pre">set_sink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sink</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ResultSink</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ResultChannel.set_sink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ResultChannel.set_sink" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.ResultChannel.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_value</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#ResultChannel.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.ResultChannel.push" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.NumericChannel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">NumericChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_hints:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#NumericChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.NumericChannel" title="Link to this definition"></a></dt>
<dd><p>Base class for <a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultChannel</span></code></a>s of numerical results, with scale/unit
semantics and optional range limits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min</strong> – Optionally, a lower limit that is not exceeded by data points (can
be used e.g. by plotting code to determine sensible value ranges to show).</p></li>
<li><p><strong>max</strong> – Optionally, an upper limit that is not exceeded by data points (can
be used e.g. by plotting code to determine sensible value ranges to show).</p></li>
<li><p><strong>unit</strong> – Name of the unit the results are given in (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;ms&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;kHz&quot;</span></code>).</p></li>
<li><p><strong>scale</strong> – Unit scaling. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default scaling as per ARTIQ’s unit
handling machinery (<code class="docutils literal notranslate"><span class="pre">artiq.language.units</span></code>) is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.FloatChannel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">FloatChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_hints:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#FloatChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.FloatChannel" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#ndscan.experiment.result_channels.NumericChannel" title="ndscan.experiment.result_channels.NumericChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericChannel</span></code></a> that accepts floating-point results.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.IntChannel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">IntChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_hints:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#IntChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.IntChannel" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#ndscan.experiment.result_channels.NumericChannel" title="ndscan.experiment.result_channels.NumericChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericChannel</span></code></a> that accepts integer results.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.result_channels.OpaqueChannel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.result_channels.</span></span><span class="sig-name descname"><span class="pre">OpaqueChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description:</span> <span class="pre">str</span> <span class="pre">=</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_hints:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_by_default:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/result_channels.html#OpaqueChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.result_channels.OpaqueChannel" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultChannel</span></code></a> that stores arbitrary data, with ndscan making no attempts
to further interpret or display it.</p>
<p>As such, opaque channels can be used to store any ancillary data for scan points,
which can later be used in custom analysis code (whether as part of a default
analysis that runs as part of the experiment code, or when manually analysing the
experimental data later).</p>
<p>Any values pushed are just passed through to the ARTIQ dataset layer; it is up to
the user to choose something compatibile with HDF5 and PYON.</p>
</dd></dl>

</section>
</section>
<section id="scans">
<h2>Scans<a class="headerlink" href="#scans" title="Link to this heading"></a></h2>
<section id="module-ndscan.experiment.scan_generator">
<span id="ndscan-experiment-scan-generator-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.scan_generator" title="ndscan.experiment.scan_generator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_generator</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.scan_generator" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_generator.</span></span><span class="sig-name descname"><span class="pre">ScanGenerator</span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator" title="Link to this definition"></a></dt>
<dd><p>Generates points along a single scan axis to be visited.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanGenerator.has_level">
<span class="sig-name descname"><span class="pre">has_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator.has_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator.has_level" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanGenerator.points_for_level">
<span class="sig-name descname"><span class="pre">points_for_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator.points_for_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator.points_for_level" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanGenerator.describe_limits">
<span class="sig-name descname"><span class="pre">describe_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanGenerator.describe_limits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanGenerator.describe_limits" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.RefiningGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_generator.</span></span><span class="sig-name descname"><span class="pre">RefiningGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lower</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#RefiningGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.RefiningGenerator" title="Link to this definition"></a></dt>
<dd><p>Generates progressively finer grid by halving distance between points each level.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.LinearGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_generator.</span></span><span class="sig-name descname"><span class="pre">LinearGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#LinearGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.LinearGenerator" title="Link to this definition"></a></dt>
<dd><p>Generates equally spaced points between two endpoints.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ListGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_generator.</span></span><span class="sig-name descname"><span class="pre">ListGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ListGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ListGenerator" title="Link to this definition"></a></dt>
<dd><p>Generates points by reading from an explicitly specified list.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_generator.</span></span><span class="sig-name descname"><span class="pre">ScanOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_repeats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise_order_globally</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_generator.html#ScanOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanOptions" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanOptions.num_repeats">
<span class="sig-name descname"><span class="pre">num_repeats</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanOptions.num_repeats" title="Link to this definition"></a></dt>
<dd><p>How many times to iterate through the specified scan points.</p>
<p>For scans with more than one level, the repetitions are executed for each level
before proceeding to the next one. This way, e.g. <a class="reference internal" href="#ndscan.experiment.scan_generator.RefiningGenerator" title="ndscan.experiment.scan_generator.RefiningGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RefiningGenerator</span></code></a>,
which produces infinitely many points, can still be employed in interactive
work when wanting to use repeats to gather statistical information.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanOptions.randomise_order_globally">
<span class="sig-name descname"><span class="pre">randomise_order_globally</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanOptions.randomise_order_globally" title="Link to this definition"></a></dt>
<dd><p>Whether to randomise the acquisition order of data points across all axes
(within a refinement level).</p>
<p>This is complementary to the randomisation options a <a class="reference internal" href="#ndscan.experiment.scan_generator.ScanGenerator" title="ndscan.experiment.scan_generator.ScanGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScanGenerator</span></code></a> will
typically have, as for a multi-dimensional scan, that alone would still lead to
data being acquired “stripe by stripe” (hyperplane by hyperplane).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ndscan.experiment.scan_generator.ScanOptions.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ndscan.experiment.scan_generator.ScanOptions.seed" title="Link to this definition"></a></dt>
<dd><p>Global seed to use for randomising the point acquisition order (if requested).</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ndscan.experiment.subscan">
<span id="ndscan-experiment-subscan-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.subscan" title="ndscan.experiment.subscan"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.subscan</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.subscan" title="Link to this heading"></a></h3>
<p>Implements subscans, that is, the ability for an <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> to scan
another child fragment as part of its execution.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.setattr_subscan">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.subscan.</span></span><span class="sig-name descname"><span class="pre">setattr_subscan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results_by_default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expose_analysis_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ndscan.experiment.subscan.Subscan" title="ndscan.experiment.subscan.Subscan"><span class="pre">Subscan</span></a></span></span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#setattr_subscan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.setattr_subscan" title="Link to this definition"></a></dt>
<dd><p>Set up a scan for the given subfragment.</p>
<p>Result channels are set up to expose the scan data in the owning fragment for
introspectability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> – The fragment to add the subscan to.</p></li>
<li><p><strong>scan_name</strong> – Name of the scan; appears in result channel names, and the
<a class="reference internal" href="#ndscan.experiment.subscan.Subscan" title="ndscan.experiment.subscan.Subscan"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subscan</span></code></a> instance will be available as <code class="docutils literal notranslate"><span class="pre">owner.&lt;scan_name&gt;</span></code>.</p></li>
<li><p><strong>fragment</strong> – The runnable fragment to iterate over in the scan. Must be a
subfragment of <code class="docutils literal notranslate"><span class="pre">owner</span></code>.</p></li>
<li><p><strong>axis_params</strong> – List of <cite>(fragment, param_name)</cite> tuples defining the axes to be
scanned. It is possible to specify more axes than are actually used; they will
be overridden and set to their default values.</p></li>
<li><p><strong>save_results_by_default</strong> – Passed on to all derived result channels.</p></li>
<li><p><strong>expose_analysis_results</strong> – Whether to add result channels to <code class="docutils literal notranslate"><span class="pre">owner</span></code> that
contain the results of default analyses set for the fragment. Note that for
this, all results must be known when this function is called (that is, all
<code class="docutils literal notranslate"><span class="pre">axis_params</span></code> should actually be scanned, and the analysis must not fail to
produce results).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <a class="reference internal" href="#ndscan.experiment.subscan.Subscan" title="ndscan.experiment.subscan.Subscan"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subscan</span></code></a> instance to use to actually execute the scan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.Subscan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.subscan.</span></span><span class="sig-name descname"><span class="pre">Subscan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanRunner" title="ndscan.experiment.scan_runner.ScanRunner"><span class="pre">ScanRunner</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanAxis" title="ndscan.experiment.scan_runner.ScanAxis"><span class="pre">ScanAxis</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SubscanChannel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_result_sinks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.result_channels.ArraySink" title="ndscan.experiment.result_channels.ArraySink"><span class="pre">ArraySink</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_result_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">short_child_channel_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_analysis_result_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#Subscan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.Subscan" title="Link to this definition"></a></dt>
<dd><p>Handle returned by <a class="reference internal" href="#ndscan.experiment.subscan.setattr_subscan" title="ndscan.experiment.subscan.setattr_subscan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setattr_subscan()</span></code></a>, allowing the subscan to actually be
executed.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.Subscan.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_generators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanGenerator" title="ndscan.experiment.scan_generator.ScanGenerator"><span class="pre">ScanGenerator</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions" title="ndscan.experiment.scan_generator.ScanOptions"><span class="pre">ScanOptions</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ScanOptions(num_repeats=1,</span> <span class="pre">randomise_order_globally=False,</span> <span class="pre">seed=439234493)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execute_default_analyses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#Subscan.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.Subscan.run" title="Link to this definition"></a></dt>
<dd><p>Run the subscan with the given axis iteration specifications, and return the
data point coordinates/result channel values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis_generators</strong> – The list of scan axes (dimensions). Each element is a
tuple of parameter to scan (handle must have been passed to
<a class="reference internal" href="#ndscan.experiment.subscan.setattr_subscan" title="ndscan.experiment.subscan.setattr_subscan"><code class="xref py py-func docutils literal notranslate"><span class="pre">setattr_subscan()</span></code></a> to set up), and the <code class="xref py py-class docutils literal notranslate"><span class="pre">ScanGenerator</span></code> to use
to generate the points.</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">ScanOptions</span></code> to control scan execution.</p></li>
<li><p><strong>execute_default_analyses</strong> – Whether to run any default analyses associated
with the subfragment after the scan is complete, even if they are not
exposed as owning fragment channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(coordinates,</span> <span class="pre">values,</span> <span class="pre">analysis_results)</span></code>, each a dictionary
mapping parameter handles, result channels and analysis channel names to
lists of their values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.SubscanExpFragment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.subscan.</span></span><span class="sig-name descname"><span class="pre">SubscanExpFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#SubscanExpFragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.SubscanExpFragment" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.SubscanExpFragment.build_fragment">
<span class="sig-name descname"><span class="pre">build_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scanned_fragment_parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scanned_fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.fragment.Fragment" title="ndscan.experiment.fragment.Fragment"><span class="pre">Fragment</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results_by_default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expose_analysis_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#SubscanExpFragment.build_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.SubscanExpFragment.build_fragment" title="Link to this definition"></a></dt>
<dd><p>Initialise this fragment, building up the hierarchy of subfragments,
parameters and result channels.</p>
<p>This is where any constructor-type initialisation should take place, similar to
the role <code class="docutils literal notranslate"><span class="pre">build()</span></code> has for a bare <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>.</p>
<p>While this method executes, the various <code class="docutils literal notranslate"><span class="pre">setattr_*()</span></code> functions can be used
to create subfragments, parameters, and result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Any extra arguments that were passed to the <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code>
constructor.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments that were passed to the
<code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> constructor.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.SubscanExpFragment.configure">
<span class="sig-name descname"><span class="pre">configure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_generators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanGenerator" title="ndscan.experiment.scan_generator.ScanGenerator"><span class="pre">ScanGenerator</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions" title="ndscan.experiment.scan_generator.ScanOptions"><span class="pre">ScanOptions</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ScanOptions(num_repeats=1,</span> <span class="pre">randomise_order_globally=False,</span> <span class="pre">seed=1731664743)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#SubscanExpFragment.configure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.SubscanExpFragment.configure" title="Link to this definition"></a></dt>
<dd><p>Configure point generators for each scan axis, and scan options.</p>
<p>This only needs to be called once (but can be called multiple times to change
settings between <cite>run_once()</cite> invocations, e.g. from a parent fragment
<cite>{host, device}_setup()</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis_generators</strong> – The list of scan axes (dimensions). Each element is a
tuple of parameter to scan (handle must have been passed to
<a class="reference internal" href="#ndscan.experiment.subscan.setattr_subscan" title="ndscan.experiment.subscan.setattr_subscan"><code class="xref py py-func docutils literal notranslate"><span class="pre">setattr_subscan()</span></code></a> to set up), and the <code class="xref py py-class docutils literal notranslate"><span class="pre">ScanGenerator</span></code> to use
to generate the points.</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">ScanOptions</span></code> to control scan execution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.SubscanExpFragment.host_setup">
<span class="sig-name descname"><span class="pre">host_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#SubscanExpFragment.host_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.SubscanExpFragment.host_setup" title="Link to this definition"></a></dt>
<dd><p>Perform host-side initialisation.</p>
<p>For fragments used as part of an on-core-device scan (i.e. with an <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code>
<code class="xref py py-meth docutils literal notranslate"><span class="pre">device_setup()</span></code>/<a class="reference internal" href="#ndscan.experiment.subscan.SubscanExpFragment.run_once" title="ndscan.experiment.subscan.SubscanExpFragment.run_once"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_once()</span></code></a>), this will be called on the host,
immediately before the top-level kernel function is entered.</p>
<p>Typical uses include initialising member variables for latter use in <code class="docutils literal notranslate"><span class="pre">&#64;kernel</span></code>
functions, and setting parameters not modifiable from kernels (e.g. because
modifying a parameter requires launching another experiment to effect the
change).</p>
<p>The default implementation calls <a class="reference internal" href="#ndscan.experiment.subscan.SubscanExpFragment.host_setup" title="ndscan.experiment.subscan.SubscanExpFragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a> recursively on all
subfragments. When overriding it in a fragment with subfragments, consider
forwarding to the default implementation (see example).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">host_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">initialise_some_things</span><span class="p">()</span>

    <span class="c1"># To continue to initialise all subfragments, invoke the parent</span>
    <span class="c1"># implementation:</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">host_setup</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.SubscanExpFragment.host_cleanup">
<span class="sig-name descname"><span class="pre">host_cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#SubscanExpFragment.host_cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.SubscanExpFragment.host_cleanup" title="Link to this definition"></a></dt>
<dd><p>Perform host-side cleanup after an experiment has been run.</p>
<p>This is the equivalent of <a class="reference internal" href="#ndscan.experiment.subscan.SubscanExpFragment.host_setup" title="ndscan.experiment.subscan.SubscanExpFragment.host_setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">host_setup()</span></code></a> to be run <em>after</em> the main
experiment. It is executed on the host after the top-level kernel function, if
any, has been left, as control is about to leave the experiment (whether because
a scan has been finished, or the experiment is about to be paused for a
higher-priority run to be scheduled in.</p>
<p>Typically, fragments should strive to completely initialise the state of all
their dependencies for robustness. As such, manual cleanup should almost never
be necessary.</p>
<p>By default, calls <cite>host_cleanup()</cite> on all subfragments, in reverse
initialisation order. The default implementation catches all exceptions thrown
from cleanups and converts them into log messages to ensure no cleanups are
skipped. As there will be no exception propagating to the caller to mark the
experiment as failed, failing cleanups should be avoided.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">host_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tear_down_some_things</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">host_setup</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.subscan.SubscanExpFragment.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/subscan.html#SubscanExpFragment.run_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.subscan.SubscanExpFragment.run_once" title="Link to this definition"></a></dt>
<dd><p>Execute the experiment described by the fragment once with the current
parameters, producing one set of results (if any).</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ndscan.experiment.default_analysis">
<span id="ndscan-experiment-default-analysis-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.default_analysis" title="ndscan.experiment.default_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.default_analysis</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.default_analysis" title="Link to this heading"></a></h3>
<p>Interfaces and declarations for analyses.</p>
<p>Conceptually, analyses are attached to a fragment, and produce results “the next level
up” – that is, they condense all the points from a scan over a particular choice of
parameters into a few parameters.</p>
<dl class="simple">
<dt>Two modalities are supported:</dt><dd><ul class="simple">
<li><p>Declarative fits of a number of pre-defined functions, to be excecuted locally by the
user interface displaying the result data, and updated as data continues to
accumulate (“online analysis”).</p></li>
<li><p>A separate analysis step executed at the end, after a scan has been completed. This
is the equivalent of ARTIQ’s <code class="docutils literal notranslate"><span class="pre">EnvExperiment.analyze()</span></code>, and is executed within the
master worker process (“execute an analysis”, “analysis results”).</p></li>
</ul>
</dd>
</dl>
<p>Both can produce annotations; particular values or plot locations highlighted in the
user interface.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.Annotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.default_analysis.</span></span><span class="sig-name descname"><span class="pre">Annotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#Annotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.Annotation" title="Link to this definition"></a></dt>
<dd><p>Annotation to be displayed alongside scan result data, recording derived
quantities (e.g. a fit minimizer).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.DefaultAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.default_analysis.</span></span><span class="sig-name descname"><span class="pre">DefaultAnalysis</span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="Link to this definition"></a></dt>
<dd><p>Analysis functionality associated with an <cite>ExpFragment</cite> to be executed when that
fragment is scanned in a particular way.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.DefaultAnalysis.required_axes">
<span class="sig-name descname"><span class="pre">required_axes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis.required_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis.required_axes" title="Link to this definition"></a></dt>
<dd><p>Return the scan axes necessary for the analysis to apply, in form of the
parameter handles.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.DefaultAnalysis.describe_online_analyses">
<span class="sig-name descname"><span class="pre">describe_online_analyses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnotationContext</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis.describe_online_analyses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis.describe_online_analyses" title="Link to this definition"></a></dt>
<dd><p>Exceute analysis and serialise information about resulting annotations and
online analyses to stringly typed metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">AnnotationContext</span></code> to use to resolve references to
fragment tree objects in user-specified data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of string dictionary representations for annotations and
online analyses (with all the fragment tree references resolved).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.DefaultAnalysis.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnotationContext</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#DefaultAnalysis.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.DefaultAnalysis.execute" title="Link to this definition"></a></dt>
<dd><p>Exceute analysis and serialise information about resulting annotations to
stringly typed metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> – The AnnotationContext to use to describe the coordinate axes/
result channels in the resulting metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of string dictionary representations for the resulting
annotations, if any.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.CustomAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.default_analysis.</span></span><span class="sig-name descname"><span class="pre">CustomAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">required_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyze_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.default_analysis.Annotation" title="ndscan.experiment.default_analysis.Annotation"><span class="pre">Annotation</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#CustomAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.CustomAnalysis" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultAnalysis</span></code></a> that executes a user-defined analysis function in the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code> step.</p>
<p>No analysis is run online.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>required_axes</strong> – List/set/… of parameters that are required as inputs for the
analysis to run (given by their <code class="xref py py-class docutils literal notranslate"><span class="pre">ParamHandle</span></code>s). The order of elements
is inconsequential.</p></li>
<li><p><strong>analyze_fn</strong> – <p>The function to invoke in the analysis step. It is passed three
dictionaries:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>a map from parameter handles to lists of the respective values for eachscan point,</p></li>
<li><p>a map from result channels to lists of results for each scan point,</p></li>
<li><p>channels for each of the optional analysis results specified in<code class="docutils literal notranslate"><span class="pre">analysis_results</span></code>, given as a dictionary indexed by channel name.</p></li>
</ol>
</div></blockquote>
<p>For backwards-compatibility, the third parameter can be omitted. Optionally, a
list of annotations to broadcast can be returned.</p>
</p></li>
<li><p><strong>analysis_results</strong> – Optionally, a number of result channels for analysis
results. They are later passed to <code class="docutils literal notranslate"><span class="pre">analyze_fn</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.OnlineFit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.default_analysis.</span></span><span class="sig-name descname"><span class="pre">OnlineFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ParamHandle</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constants</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#OnlineFit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.OnlineFit" title="Link to this definition"></a></dt>
<dd><p>Describes an automatically executed fit for a given combination of scan axes
and result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_type</strong> – Fitting procedure name, per <code class="xref py py-data docutils literal notranslate"><span class="pre">FIT_OBJECTS</span></code>.</p></li>
<li><p><strong>data</strong> – Maps fit data axis names (<code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>) to parameter handles or
result channels that supply the respective data.</p></li>
<li><p><strong>annotations</strong> – Any points of interest to highlight in the fit results,
given in the form of a dictionary mapping (arbitrary) identifiers to
dictionaries mapping coordinate names to fit result names. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT_FIT_ANNOTATIONS</span></code> will be queried.</p></li>
<li><p><strong>analysis_identifier</strong> – Optional explicit name to use for online analysis.
Defaults to <code class="docutils literal notranslate"><span class="pre">fit_&lt;fit_type&gt;</span></code>, but can be set explicitly to allow more than one
fit of a given type at a time.</p></li>
<li><p><strong>constants</strong> – Specifies parameters to be held constant during the fit. This is
a dictionary mapping fit parameter names to the respective constant values,
forwarded to <code class="xref py py-meth docutils literal notranslate"><span class="pre">oitg.fitting.FitBase.FitBase.fit()</span></code>.</p></li>
<li><p><strong>initial_values</strong> – Specifies initial values for the fit parameters. This is
a dictionary mapping fit parameter names to the respective values, forwarded to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">oitg.fitting.FitBase.FitBase.fit()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.default_analysis.</span></span><span class="sig-name descname"><span class="pre">ResultPrefixAnalysisWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#ResultPrefixAnalysisWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper" title="Link to this definition"></a></dt>
<dd><p>Wraps another default analysis, prepending the given string to the name of each
analysis result.</p>
<p>This can be used to disambiguate potential conflicts between result names when
programmatically collecting analyses from multiple sources.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper.required_axes">
<span class="sig-name descname"><span class="pre">required_axes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">ParamHandle</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#ResultPrefixAnalysisWrapper.required_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper.required_axes" title="Link to this definition"></a></dt>
<dd><p>Return the scan axes necessary for the analysis to apply, in form of the
parameter handles.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper.describe_online_analyses">
<span class="sig-name descname"><span class="pre">describe_online_analyses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnotationContext</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#ResultPrefixAnalysisWrapper.describe_online_analyses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper.describe_online_analyses" title="Link to this definition"></a></dt>
<dd><p>Exceute analysis and serialise information about resulting annotations and
online analyses to stringly typed metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">AnnotationContext</span></code> to use to resolve references to
fragment tree objects in user-specified data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of string dictionary representations for annotations and
online analyses (with all the fragment tree references resolved).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnotationContext</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/default_analysis.html#ResultPrefixAnalysisWrapper.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.default_analysis.ResultPrefixAnalysisWrapper.execute" title="Link to this definition"></a></dt>
<dd><p>Exceute analysis and serialise information about resulting annotations to
stringly typed metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> – The AnnotationContext to use to describe the coordinate axes/
result channels in the resulting metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of string dictionary representations for the resulting
annotations, if any.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-ndscan.experiment.scan_runner">
<span id="ndscan-experiment-scan-runner-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.scan_runner" title="ndscan.experiment.scan_runner"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.scan_runner</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.scan_runner" title="Link to this heading"></a></h3>
<p>Generic scanning loop.</p>
<p>While <a class="reference internal" href="#module-ndscan.experiment.scan_generator" title="ndscan.experiment.scan_generator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scan_generator</span></code></a> describes a scan to be run in the abstract, this module
contains the implementation to actually execute one within an ARTIQ experiment. This
will likely be used by end users via
<a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="ndscan.experiment.entry_point.FragmentScanExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">FragmentScanExperiment</span></code></a> or subscans.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanAxis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">ScanAxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_store</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamStore</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanAxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanAxis" title="Link to this definition"></a></dt>
<dd><p>Describes a single axis that is being scanned.</p>
<p>Apart from the metadata, this also includes the necessary information to execute the
scan at runtime; i.e. the <code class="xref py py-class docutils literal notranslate"><span class="pre">ParamStore</span></code> to modify in order to set the
parameter.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanSpec">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">ScanSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanAxis" title="ndscan.experiment.scan_runner.ScanAxis"><span class="pre">ScanAxis</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanGenerator" title="ndscan.experiment.scan_generator.ScanGenerator"><span class="pre">ScanGenerator</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions" title="ndscan.experiment.scan_generator.ScanOptions"><span class="pre">ScanOptions</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanSpec" title="Link to this definition"></a></dt>
<dd><p>Describes a single scan.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanSpec.axes">
<span class="sig-name descname"><span class="pre">axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanAxis" title="ndscan.experiment.scan_runner.ScanAxis"><span class="pre">ScanAxis</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanSpec.axes" title="Link to this definition"></a></dt>
<dd><p>The list of parameters that are scanned.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanSpec.generators">
<span class="sig-name descname"><span class="pre">generators</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanGenerator" title="ndscan.experiment.scan_generator.ScanGenerator"><span class="pre">ScanGenerator</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanSpec.generators" title="Link to this definition"></a></dt>
<dd><p>Generators that give the points for each of the specified axes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanSpec.options">
<span class="sig-name descname"><span class="pre">options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions" title="ndscan.experiment.scan_generator.ScanOptions"><span class="pre">ScanOptions</span></a></em><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanSpec.options" title="Link to this definition"></a></dt>
<dd><p>Applicable <a class="reference internal" href="#ndscan.experiment.scan_generator.ScanOptions" title="ndscan.experiment.scan_generator.ScanOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScanOptions</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">ScanRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanRunner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanRunner" title="Link to this definition"></a></dt>
<dd><p>Runs the actual loop that executes an <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> for a specified list
of scan axes (on either the host or core device, as appropriate).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanRunner.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_rtio_underflow_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_transitory_error_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_on_persistent_transitory_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanRunner.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanRunner.build" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_rtio_underflow_retries</strong> – Number of RTIOUnderflows to tolerate per scan
point (by simply trying again) before giving up. Three is a pretty arbitrary
default – we don’t want to block forever in case the experiment is faulty,
but also want to tolerate ~1% underflow chance for experiments where tight
timing is critical.</p></li>
<li><p><strong>max_transitory_error_retries</strong> – Number of transitory errors to tolerate per
scan point (by simply trying again) before giving up.</p></li>
<li><p><strong>skip_on_persistent_transitory_error</strong> – By default, transitory errors above
the configured limit are raised for the calling code to handle (possibly
terminating the experiment). If <code class="docutils literal notranslate"><span class="pre">True</span></code>, points with too many transitory
errors will be skipped instead after logging an error. Consequences for
overall system robustness should be considered before using this in
automated code.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanRunner.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanSpec" title="ndscan.experiment.scan_runner.ScanSpec"><span class="pre">ScanSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_sinks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultSink</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanRunner.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanRunner.run" title="Link to this definition"></a></dt>
<dd><p>Run a scan of the given fragment, with axes as specified.</p>
<p>Integrates with the ARTIQ scheduler to pause/terminate execution as requested.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> – The fragment to iterate.</p></li>
<li><p><strong>options</strong> – The options for the scan generator.</p></li>
<li><p><strong>axis_sinks</strong> – A list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultSink</span></code> instances to push the
coordinates for each scan point to, matching <code class="docutils literal notranslate"><span class="pre">scan.axes</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.ScanRunner.acquire">
<span class="sig-name descname"><span class="pre">acquire</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#ScanRunner.acquire"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.ScanRunner.acquire" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">true</span></code> if scan is complete, <code class="docutils literal notranslate"><span class="pre">false</span></code> if the scan has been
interrupted and <code class="docutils literal notranslate"><span class="pre">acquire()</span></code> should be called again to complete it.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.match_default_analysis">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">match_default_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanAxis" title="ndscan.experiment.scan_runner.ScanAxis"><span class="pre">ScanAxis</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#match_default_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.match_default_analysis" title="Link to this definition"></a></dt>
<dd><p>Return whether the given default analysis can be executed for the given scan
axes.</p>
<p>The implementation is currently a bit more convoluted than necessary, as we want to
catch cases where the parameter specified by the analysis is scanned indirectly
through overrides. (TODO: Do we really, though? This matches the behaviour prior to
the refactoring towards exposing a set of required axis handles from
DefaultAnalysis, but we should revisit this.)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.filter_default_analyses">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">filter_default_analyses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanAxis" title="ndscan.experiment.scan_runner.ScanAxis"><span class="pre">ScanAxis</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#filter_default_analyses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.filter_default_analyses" title="Link to this definition"></a></dt>
<dd><p>Return the default analyses of the given fragment that can be executed for the
given scan spec.</p>
<p>See <a class="reference internal" href="#ndscan.experiment.scan_runner.match_default_analysis" title="ndscan.experiment.scan_runner.match_default_analysis"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_default_analysis()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.describe_scan">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">describe_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.scan_runner.ScanSpec" title="ndscan.experiment.scan_runner.ScanSpec"><span class="pre">ScanSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">short_result_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#describe_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.describe_scan" title="Link to this definition"></a></dt>
<dd><p>Return metadata for the given spec in stringly typed dictionary form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – <a class="reference internal" href="#ndscan.experiment.scan_runner.ScanSpec" title="ndscan.experiment.scan_runner.ScanSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScanSpec</span></code></a> describing the scan.</p></li>
<li><p><strong>fragment</strong> – Fragment being scanned.</p></li>
<li><p><strong>short_result_names</strong> – Map from result channel objects to shortened names.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.scan_runner.describe_analyses">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.scan_runner.</span></span><span class="sig-name descname"><span class="pre">describe_analyses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analyses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><span class="pre">DefaultAnalysis</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnotationContext</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/scan_runner.html#describe_analyses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.scan_runner.describe_analyses" title="Link to this definition"></a></dt>
<dd><p>Return metadata for the given analyses in stringly typed dictionary form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analyses</strong> – The <a class="reference internal" href="#ndscan.experiment.default_analysis.DefaultAnalysis" title="ndscan.experiment.default_analysis.DefaultAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultAnalysis</span></code></a> objects to describe (already filtered
to those that apply to the scan, and thus are describable by the context).</p></li>
<li><p><strong>context</strong> – Used to resolve any references to scanned parameters/results
channels/analysis results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The analysis metadata (<code class="docutils literal notranslate"><span class="pre">annotations</span></code>/<code class="docutils literal notranslate"><span class="pre">online_analyses</span></code>), with all
references to fragment tree objects resolved, and ready for JSON/…
serialisation.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="experiment-entry-points">
<h2>Experiment entry points<a class="headerlink" href="#experiment-entry-points" title="Link to this heading"></a></h2>
<section id="module-ndscan.experiment.entry_point">
<span id="ndscan-experiment-entry-point-module"></span><h3><a class="reference internal" href="#module-ndscan.experiment.entry_point" title="ndscan.experiment.entry_point"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.experiment.entry_point</span></code></a> module<a class="headerlink" href="#module-ndscan.experiment.entry_point" title="Link to this heading"></a></h3>
<p>Top-level functions for launching <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>s and their scans from the rest
of the ARTIQ <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> universe.</p>
<p>The two main entry points into the <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> universe are</p>
<blockquote>
<div><ul class="simple">
<li><p>scans (with axes and overrides set from the dashboard UI) via
<a class="reference internal" href="#ndscan.experiment.entry_point.make_fragment_scan_exp" title="ndscan.experiment.entry_point.make_fragment_scan_exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_fragment_scan_exp()</span></code></a>, and</p></li>
<li><p>manually launched fragments from vanilla ARTIQ <code class="docutils literal notranslate"><span class="pre">EnvExperiment</span></code>s using
<a class="reference internal" href="#ndscan.experiment.entry_point.run_fragment_once" title="ndscan.experiment.entry_point.run_fragment_once"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_fragment_once()</span></code></a> or <a class="reference internal" href="#ndscan.experiment.entry_point.create_and_run_fragment_once" title="ndscan.experiment.entry_point.create_and_run_fragment_once"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_and_run_fragment_once()</span></code></a>.</p></li>
</ul>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.make_fragment_scan_exp">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.entry_point.</span></span><span class="sig-name descname"><span class="pre">make_fragment_scan_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rtio_underflow_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_transitory_error_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="ndscan.experiment.entry_point.FragmentScanExperiment"><span class="pre">FragmentScanExperiment</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#make_fragment_scan_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.make_fragment_scan_exp" title="Link to this definition"></a></dt>
<dd><p>Create a <a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="ndscan.experiment.entry_point.FragmentScanExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">FragmentScanExperiment</span></code></a> subclass that scans the given
<a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>, ready to be picked up by the ARTIQ explorer/…</p>
<p>This is the default way of creating scan experiments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyExpFragment</span><span class="p">(</span><span class="n">ExpFragment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>

    <span class="k">def</span> <span class="nf">run_once</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>

<span class="n">MyExpFragmentScan</span> <span class="o">=</span> <span class="n">make_fragment_scan_exp</span><span class="p">(</span><span class="n">MyExpFragment</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.FragmentScanExperiment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.entry_point.</span></span><span class="sig-name descname"><span class="pre">FragmentScanExperiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers_or_parent</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment" title="Link to this definition"></a></dt>
<dd><p>Implements possibly (trivial) scans of an <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>, with overrides
and scan axes as specified by the <code class="xref py py-data docutils literal notranslate"><span class="pre">PARAMS_ARG_KEY</span></code> dataset, and result
channels being broadcasted to datasets.</p>
<p>See <a class="reference internal" href="#ndscan.experiment.entry_point.make_fragment_scan_exp" title="ndscan.experiment.entry_point.make_fragment_scan_exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_fragment_scan_exp()</span></code></a> for a convenience method to create subclasses for
a specific <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.FragmentScanExperiment.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rtio_underflow_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_transitory_error_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.build" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment_init</strong> – Callable to create the top-level <code class="xref py py-meth docutils literal notranslate"><span class="pre">ExpFragment()</span></code>
instance.</p></li>
<li><p><strong>max_rtio_underflow_retries</strong> – Number of RTIOUnderflows to tolerate per scan
point (by simply trying again) before giving up.</p></li>
<li><p><strong>max_transitory_error_retries</strong> – Number of transitory errors to tolerate per
scan point (by simply trying again) before giving up.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.FragmentScanExperiment.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.prepare" title="Link to this definition"></a></dt>
<dd><p>Collect parameters to set from both scan axes and simple overrides, and
initialise result channels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.FragmentScanExperiment.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.run" title="Link to this definition"></a></dt>
<dd><p>The main entry point of the experiment.</p>
<p>This method must be overloaded by the user to implement the main
control flow of the experiment.</p>
<p>This method may interact with the hardware.</p>
<p>The experiment may call the scheduler’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">pause()</span></code> method while in
<a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment.run" title="ndscan.experiment.entry_point.FragmentScanExperiment.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.FragmentScanExperiment.analyze">
<span class="sig-name descname"><span class="pre">analyze</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#FragmentScanExperiment.analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.FragmentScanExperiment.analyze" title="Link to this definition"></a></dt>
<dd><p>Entry point for analyzing the results of the experiment.</p>
<p>This method may be overloaded by the user to implement the analysis
phase of the experiment, for example fitting curves.</p>
<p>Splitting this phase from <a class="reference internal" href="#ndscan.experiment.entry_point.FragmentScanExperiment.run" title="ndscan.experiment.entry_point.FragmentScanExperiment.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> enables tweaking the analysis
algorithm on pre-existing data, and CPU-bound analyses to be run
overlapped with the next experiment in a pipelined manner.</p>
<p>This method must not interact with the hardware.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.ScanSpecError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ndscan.experiment.entry_point.</span></span><span class="sig-name descname"><span class="pre">ScanSpecError</span></span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#ScanSpecError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.ScanSpecError" title="Link to this definition"></a></dt>
<dd><p>Raised when the scan specification passed in <code class="xref py py-data docutils literal notranslate"><span class="pre">PARAMS_ARG_KEY</span></code> is not valid
for the given fragment.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.run_fragment_once">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.entry_point.</span></span><span class="sig-name descname"><span class="pre">run_fragment_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rtio_underflow_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_transitory_error_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.result_channels.ResultChannel" title="ndscan.experiment.result_channels.ResultChannel"><span class="pre">ResultChannel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#run_fragment_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.run_fragment_once" title="Link to this definition"></a></dt>
<dd><p>Initialise the passed fragment and run it once, capturing and returning the
values from any result channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_transitory_error_retries</strong> – Number of times to catch transitory error
exceptions and retry execution. If exceeded, the exception is re-raised for
the caller to handle. If <code class="docutils literal notranslate"><span class="pre">0</span></code>, retrying is disabled entirely.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping <code class="xref py py-class docutils literal notranslate"><span class="pre">ResultChannel</span></code> instances to their values
(or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not pushed to).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.experiment.entry_point.create_and_run_fragment_once">
<span class="sig-prename descclassname"><span class="pre">ndscan.experiment.entry_point.</span></span><span class="sig-name descname"><span class="pre">create_and_run_fragment_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">HasEnvironment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><span class="pre">ExpFragment</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rtio_underflow_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_transitory_error_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/experiment/entry_point.html#create_and_run_fragment_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.experiment.entry_point.create_and_run_fragment_once" title="Link to this definition"></a></dt>
<dd><p>Create an instance of the passed <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> type and runs it once,
returning the values pushed to any result channels.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyExpFragment</span><span class="p">(</span><span class="n">ExpFragment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr_result</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_once</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span>

<span class="k">class</span> <span class="nc">MyEnvExperiment</span><span class="p">(</span><span class="n">EnvExperiment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">create_and_run_once</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MyExpFragment</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – The <code class="docutils literal notranslate"><span class="pre">HasEnvironment</span></code> to use.</p></li>
<li><p><strong>fragment_class</strong> – The <a class="reference internal" href="#ndscan.experiment.fragment.ExpFragment" title="ndscan.experiment.fragment.ExpFragment"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpFragment</span></code></a> class to instantiate.</p></li>
<li><p><strong>args</strong> – Any arguments to forward to <code class="docutils literal notranslate"><span class="pre">build_fragment()</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any keyword arguments to forward to <code class="docutils literal notranslate"><span class="pre">build_fragment()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping result channel names to their values (or <code class="docutils literal notranslate"><span class="pre">None</span></code> if
not pushed to).</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
<section id="module-ndscan.results">
<span id="ndscan-results-api"></span><h1>ndscan.results API<a class="headerlink" href="#module-ndscan.results" title="Link to this heading"></a></h1>
<section id="module-ndscan.results.arguments">
<span id="ndscan-results-arguments-module"></span><h2><a class="reference internal" href="#module-ndscan.results.arguments" title="ndscan.results.arguments"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.results.arguments</span></code></a> module<a class="headerlink" href="#module-ndscan.results.arguments" title="Link to this heading"></a></h2>
<p>Functions for pretty-printing user argument data (scan parameters, overrides, …) for
FragmentScanExperiments from ARTIQ results.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.arguments.extract_param_schema">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.arguments.</span></span><span class="sig-name descname"><span class="pre">extract_param_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arguments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/results/arguments.html#extract_param_schema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.arguments.extract_param_schema" title="Link to this definition"></a></dt>
<dd><p>Extract ndscan parameter data from the given ARTIQ arguments directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arguments</strong> – The arguments for an ARTIQ experiment, as e.g. obtained using
<code class="docutils literal notranslate"><span class="pre">oitg.results.load_hdf5_file(…)[&quot;expid&quot;][&quot;arguments&quot;]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.arguments.dump_overrides">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.arguments.</span></span><span class="sig-name descname"><span class="pre">dump_overrides</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/results/arguments.html#dump_overrides"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.arguments.dump_overrides" title="Link to this definition"></a></dt>
<dd><p>Format information about overrides as a human-readable string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generator yielding the output line-by-line.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.arguments.dump_scan">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.arguments.</span></span><span class="sig-name descname"><span class="pre">dump_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/results/arguments.html#dump_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.arguments.dump_scan" title="Link to this definition"></a></dt>
<dd><p>Format information about the configured scan (if any) as a human-readable string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generator yielding the output line-by-line.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.arguments.summarise">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.arguments.</span></span><span class="sig-name descname"><span class="pre">summarise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/ndscan/results/arguments.html#summarise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.arguments.summarise" title="Link to this definition"></a></dt>
<dd><p>Convenience method returning a combination of <a class="reference internal" href="#ndscan.results.arguments.dump_overrides" title="ndscan.results.arguments.dump_overrides"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump_overrides()</span></code></a> and
<a class="reference internal" href="#ndscan.results.arguments.dump_scan" title="ndscan.results.arguments.dump_scan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump_scan()</span></code></a> ready to be printed.</p>
</dd></dl>

</section>
<section id="module-ndscan.results.pyplot">
<span id="ndscan-results-pyplot-module"></span><h2><a class="reference internal" href="#module-ndscan.results.pyplot" title="ndscan.results.pyplot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.results.pyplot</span></code></a> module<a class="headerlink" href="#module-ndscan.results.pyplot" title="Link to this heading"></a></h2>
<p>Functions to automatically display plots for ndscan data using Matplotlib.</p>
<p>These are not intended to be a fully-featured replacement for <code class="docutils literal notranslate"><span class="pre">ndscan.plots</span></code>, just a
quick way to peek at data in a Matplotlib-centric workflow where pyqtgraph might not be
available.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.pyplot.make_default_plot">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.pyplot.</span></span><span class="sig-name descname"><span class="pre">make_default_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">datasets:</span> <span class="pre">dict[str,</span> <span class="pre">~typing.Any],</span> <span class="pre">root:</span> <span class="pre">str,</span> <span class="pre">figure,</span> <span class="pre">*,</span> <span class="pre">channel_filter=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/results/pyplot.html#make_default_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.pyplot.make_default_plot" title="Link to this definition"></a></dt>
<dd><p>Render a plot for the specified ndscan root to the given PyPlot figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>channel_filter</strong> – Called with the name for each result channel; if False, the
channel is not displayed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.pyplot.auto_plot">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.pyplot.</span></span><span class="sig-name descname"><span class="pre">auto_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">datasets:</span> <span class="pre">dict[str,</span> <span class="pre">~typing.Any],</span> <span class="pre">*,</span> <span class="pre">channel_filter=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ndscan/results/pyplot.html#auto_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.pyplot.auto_plot" title="Link to this definition"></a></dt>
<dd><p>Display PyPlot figures for all the ndscan roots found among the passed datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>channel_filter</strong> – Called with the name for each result channel; if False, the
channel is not displayed.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ndscan.results.tools">
<span id="ndscan-results-tools-module"></span><h2><a class="reference internal" href="#module-ndscan.results.tools" title="ndscan.results.tools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndscan.results.tools</span></code></a> module<a class="headerlink" href="#module-ndscan.results.tools" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ndscan.results.tools.find_ndscan_roots">
<span class="sig-prename descclassname"><span class="pre">ndscan.results.tools.</span></span><span class="sig-name descname"><span class="pre">find_ndscan_roots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ndscan/results/tools.html#find_ndscan_roots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ndscan.results.tools.find_ndscan_roots" title="Link to this definition"></a></dt>
<dd><p>Detect ndscan roots among the passed datasets, and returns a list of the name
prefixes (e.g. <code class="docutils literal notranslate"><span class="pre">ndscan.</span></code>).</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="ndscan" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coding-conventions.html" class="btn btn-neutral float-right" title="Coding conventions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, David Nadlinger.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>